Traceback (most recent call last):
  File "/Users/chandrasingh/opt/anaconda3/envs/fast/lib/python3.8/site-packages/jupyter_cache/executors/utils.py", line 51, in single_nb_execution
    executenb(
  File "/Users/chandrasingh/opt/anaconda3/envs/fast/lib/python3.8/site-packages/nbclient/client.py", line 1204, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
  File "/Users/chandrasingh/opt/anaconda3/envs/fast/lib/python3.8/site-packages/nbclient/util.py", line 84, in wrapped
    return just_run(coro(*args, **kwargs))
  File "/Users/chandrasingh/opt/anaconda3/envs/fast/lib/python3.8/site-packages/nbclient/util.py", line 62, in just_run
    return loop.run_until_complete(coro)
  File "/Users/chandrasingh/opt/anaconda3/envs/fast/lib/python3.8/asyncio/base_events.py", line 616, in run_until_complete
    return future.result()
  File "/Users/chandrasingh/opt/anaconda3/envs/fast/lib/python3.8/site-packages/nbclient/client.py", line 663, in async_execute
    await self.async_execute_cell(
  File "/Users/chandrasingh/opt/anaconda3/envs/fast/lib/python3.8/site-packages/nbclient/client.py", line 965, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "/Users/chandrasingh/opt/anaconda3/envs/fast/lib/python3.8/site-packages/nbclient/client.py", line 862, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
# train_set is the training DataFrame
write_tfrecords(train_set, 'train.tfrecords')

# eval_set is the evaluation DataFrame
write_tfrecords(eval_set, 'eval.tfrecords')
------------------

[0;31m---------------------------------------------------------------------------[0m
[0;31mKeyboardInterrupt[0m                         Traceback (most recent call last)
Input [0;32mIn [31][0m, in [0;36m<cell line: 2>[0;34m()[0m
[1;32m      1[0m [38;5;66;03m# train_set is the training DataFrame[39;00m
[0;32m----> 2[0m [43mwrite_tfrecords[49m[43m([49m[43mtrain_set[49m[43m,[49m[43m [49m[38;5;124;43m'[39;49m[38;5;124;43mtrain.tfrecords[39;49m[38;5;124;43m'[39;49m[43m)[49m
[1;32m      4[0m [38;5;66;03m# eval_set is the evaluation DataFrame[39;00m
[1;32m      5[0m write_tfrecords(eval_set, [38;5;124m'[39m[38;5;124meval.tfrecords[39m[38;5;124m'[39m)

Input [0;32mIn [30][0m, in [0;36mwrite_tfrecords[0;34m(dataset, tfrecords_file, has_labels)[0m
[1;32m      4[0m writer [38;5;241m=[39m tf[38;5;241m.[39mio[38;5;241m.[39mTFRecordWriter(tfrecords_file)
[1;32m      5[0m [38;5;28;01mfor[39;00m i [38;5;129;01min[39;00m [38;5;28mrange[39m([38;5;28mlen[39m(dataset)):
[0;32m----> 6[0m     example [38;5;241m=[39m [43mcreate_example[49m[43m([49m[43mdataset[49m[38;5;241;43m.[39;49m[43miloc[49m[43m[[49m[43mi[49m[43m][49m[43m,[49m[43m [49m[43mhas_labels[49m[43m)[49m
[1;32m      7[0m     writer[38;5;241m.[39mwrite(example[38;5;241m.[39mSerializeToString())
[1;32m      8[0m writer[38;5;241m.[39mclose()

Input [0;32mIn [29][0m, in [0;36mcreate_example[0;34m(dataset_row, has_labels)[0m
[1;32m      2[0m [38;5;28;01mdef[39;00m [38;5;21mcreate_example[39m(dataset_row, has_labels):
[1;32m      3[0m     feature_dict [38;5;241m=[39m {}
[0;32m----> 4[0m     [43madd_int_features[49m[43m([49m[43mdataset_row[49m[43m,[49m[43m [49m[43mfeature_dict[49m[43m)[49m
[1;32m      5[0m     add_float_features(dataset_row, feature_dict, has_labels)
[1;32m      6[0m     [38;5;66;03m# CODE HERE[39;00m

Input [0;32mIn [26][0m, in [0;36madd_int_features[0;34m(dataset_row, feature_dict)[0m
[1;32m      6[0m int_vals [38;5;241m=[39m [[38;5;124m'[39m[38;5;124mStore[39m[38;5;124m'[39m, [38;5;124m'[39m[38;5;124mDept[39m[38;5;124m'[39m, [38;5;124m'[39m[38;5;124mIsHoliday[39m[38;5;124m'[39m, [38;5;124m'[39m[38;5;124mSize[39m[38;5;124m'[39m]
[1;32m      7[0m [38;5;28;01mfor[39;00m feature_name [38;5;129;01min[39;00m int_vals:
[0;32m----> 8[0m     list_val [38;5;241m=[39m tf[38;5;241m.[39mtrain[38;5;241m.[39mInt64List(value[38;5;241m=[39m[[43mdataset_row[49m[43m[[49m[43mfeature_name[49m[43m][49m])
[1;32m      9[0m     feature_dict[feature_name] [38;5;241m=[39m tf[38;5;241m.[39mtrain[38;5;241m.[39mFeature(int64_list [38;5;241m=[39m list_val)

File [0;32m~/opt/anaconda3/envs/fast/lib/python3.8/site-packages/pandas/core/series.py:958[0m, in [0;36mSeries.__getitem__[0;34m(self, key)[0m
[1;32m    955[0m     [38;5;28;01mreturn[39;00m [38;5;28mself[39m[38;5;241m.[39m_values[key]
[1;32m    957[0m [38;5;28;01melif[39;00m key_is_scalar:
[0;32m--> 958[0m     [38;5;28;01mreturn[39;00m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_get_value[49m[43m([49m[43mkey[49m[43m)[49m
[1;32m    960[0m [38;5;28;01mif[39;00m is_hashable(key):
[1;32m    961[0m     [38;5;66;03m# Otherwise index.get_value will raise InvalidIndexError[39;00m
[1;32m    962[0m     [38;5;28;01mtry[39;00m:
[1;32m    963[0m         [38;5;66;03m# For labels that don't resolve as scalars like tuples and frozensets[39;00m

File [0;32m~/opt/anaconda3/envs/fast/lib/python3.8/site-packages/pandas/core/series.py:1069[0m, in [0;36mSeries._get_value[0;34m(self, label, takeable)[0m
[1;32m   1066[0m     [38;5;28;01mreturn[39;00m [38;5;28mself[39m[38;5;241m.[39m_values[label]
[1;32m   1068[0m [38;5;66;03m# Similar to Index.get_value, but we do not fall back to positional[39;00m
[0;32m-> 1069[0m loc [38;5;241m=[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mindex[49m[38;5;241;43m.[39;49m[43mget_loc[49m[43m([49m[43mlabel[49m[43m)[49m
[1;32m   1070[0m [38;5;28;01mreturn[39;00m [38;5;28mself[39m[38;5;241m.[39mindex[38;5;241m.[39m_get_values_for_loc([38;5;28mself[39m, loc, label)

File [0;32m~/opt/anaconda3/envs/fast/lib/python3.8/site-packages/pandas/core/indexes/base.py:3619[0m, in [0;36mIndex.get_loc[0;34m(self, key, method, tolerance)[0m
[1;32m   3614[0m [38;5;28;01mif[39;00m tolerance [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m:
[1;32m   3615[0m     [38;5;28;01mraise[39;00m [38;5;167;01mValueError[39;00m(
[1;32m   3616[0m         [38;5;124m"[39m[38;5;124mtolerance argument only valid if using pad, [39m[38;5;124m"[39m
[1;32m   3617[0m         [38;5;124m"[39m[38;5;124mbackfill or nearest lookups[39m[38;5;124m"[39m
[1;32m   3618[0m     )
[0;32m-> 3619[0m casted_key [38;5;241m=[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_maybe_cast_indexer[49m[43m([49m[43mkey[49m[43m)[49m
[1;32m   3620[0m [38;5;28;01mtry[39;00m:
[1;32m   3621[0m     [38;5;28;01mreturn[39;00m [38;5;28mself[39m[38;5;241m.[39m_engine[38;5;241m.[39mget_loc(casted_key)

File [0;32m~/opt/anaconda3/envs/fast/lib/python3.8/site-packages/pandas/core/indexes/base.py:6289[0m, in [0;36mIndex._maybe_cast_indexer[0;34m(self, key)[0m
[1;32m   6284[0m [38;5;28;01mdef[39;00m [38;5;21m_maybe_cast_indexer[39m([38;5;28mself[39m, key):
[1;32m   6285[0m     [38;5;124;03m"""[39;00m
[1;32m   6286[0m [38;5;124;03m    If we have a float key and are not a floating index, then try to cast[39;00m
[1;32m   6287[0m [38;5;124;03m    to an int if equivalent.[39;00m
[1;32m   6288[0m [38;5;124;03m    """[39;00m
[0;32m-> 6289[0m     [38;5;28;01mif[39;00m [38;5;129;01mnot[39;00m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mis_floating[49m[43m([49m[43m)[49m:
[1;32m   6290[0m         [38;5;28;01mreturn[39;00m com[38;5;241m.[39mcast_scalar_indexer(key)
[1;32m   6291[0m     [38;5;28;01mreturn[39;00m key

File [0;32m~/opt/anaconda3/envs/fast/lib/python3.8/site-packages/pandas/core/indexes/base.py:2386[0m, in [0;36mIndex.is_floating[0;34m(self)[0m
[1;32m   2344[0m [38;5;129m@final[39m
[1;32m   2345[0m [38;5;28;01mdef[39;00m [38;5;21mis_floating[39m([38;5;28mself[39m) [38;5;241m-[39m[38;5;241m>[39m [38;5;28mbool[39m:
[1;32m   2346[0m     [38;5;124;03m"""[39;00m
[1;32m   2347[0m [38;5;124;03m    Check if the Index is a floating type.[39;00m
[1;32m   2348[0m 
[0;32m   (...)[0m
[1;32m   2384[0m [38;5;124;03m    False[39;00m
[1;32m   2385[0m [38;5;124;03m    """[39;00m
[0;32m-> 2386[0m     [38;5;28;01mreturn[39;00m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43minferred_type[49m[43m [49m[38;5;129;43;01min[39;49;00m[43m [49m[43m[[49m[38;5;124;43m"[39;49m[38;5;124;43mfloating[39;49m[38;5;124;43m"[39;49m[43m,[49m[43m [49m[38;5;124;43m"[39;49m[38;5;124;43mmixed-integer-float[39;49m[38;5;124;43m"[39;49m[43m,[49m[43m [49m[38;5;124;43m"[39;49m[38;5;124;43minteger-na[39;49m[38;5;124;43m"[39;49m[43m][49m

[0;31mKeyboardInterrupt[0m: 
KeyboardInterrupt: 

