Traceback (most recent call last):
  File "/Users/chandrasingh/opt/anaconda3/envs/fast/lib/python3.8/site-packages/jupyter_cache/executors/utils.py", line 51, in single_nb_execution
    executenb(
  File "/Users/chandrasingh/opt/anaconda3/envs/fast/lib/python3.8/site-packages/nbclient/client.py", line 1204, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
  File "/Users/chandrasingh/opt/anaconda3/envs/fast/lib/python3.8/site-packages/nbclient/util.py", line 84, in wrapped
    return just_run(coro(*args, **kwargs))
  File "/Users/chandrasingh/opt/anaconda3/envs/fast/lib/python3.8/site-packages/nbclient/util.py", line 62, in just_run
    return loop.run_until_complete(coro)
  File "/Users/chandrasingh/opt/anaconda3/envs/fast/lib/python3.8/asyncio/base_events.py", line 616, in run_until_complete
    return future.result()
  File "/Users/chandrasingh/opt/anaconda3/envs/fast/lib/python3.8/site-packages/nbclient/client.py", line 663, in async_execute
    await self.async_execute_cell(
  File "/Users/chandrasingh/opt/anaconda3/envs/fast/lib/python3.8/site-packages/nbclient/client.py", line 965, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "/Users/chandrasingh/opt/anaconda3/envs/fast/lib/python3.8/site-packages/nbclient/client.py", line 862, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
als = ALS(
    maxIter=MAX_ITER, 
    rank=RANK,
    regParam=REG_PARAM, 
    userCol=COL_USER, 
    itemCol=COL_ITEM, 
    ratingCol=COL_RATING, 
    coldStartStrategy="drop"
)

model = als.fit(dfs_train)
------------------

[0;31m---------------------------------------------------------------------------[0m
[0;31mPy4JJavaError[0m                             Traceback (most recent call last)
    [0;31m[... skipping hidden 1 frame][0m

Input [0;32mIn [12][0m, in [0;36m<cell line: 11>[0;34m()[0m
[1;32m      1[0m als [38;5;241m=[39m ALS(
[1;32m      2[0m     maxIter[38;5;241m=[39mMAX_ITER, 
[1;32m      3[0m     rank[38;5;241m=[39mRANK,
[0;32m   (...)[0m
[1;32m      8[0m     coldStartStrategy[38;5;241m=[39m[38;5;124m"[39m[38;5;124mdrop[39m[38;5;124m"[39m
[1;32m      9[0m )
[0;32m---> 11[0m model [38;5;241m=[39m [43mals[49m[38;5;241;43m.[39;49m[43mfit[49m[43m([49m[43mdfs_train[49m[43m)[49m

File [0;32m~/opt/anaconda3/envs/reco/lib/python3.8/site-packages/pyspark/ml/base.py:161[0m, in [0;36mEstimator.fit[0;34m(self, dataset, params)[0m
[1;32m    160[0m     [38;5;28;01melse[39;00m:
[0;32m--> 161[0m         [38;5;28;01mreturn[39;00m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_fit[49m[43m([49m[43mdataset[49m[43m)[49m
[1;32m    162[0m [38;5;28;01melse[39;00m:

File [0;32m~/opt/anaconda3/envs/reco/lib/python3.8/site-packages/pyspark/ml/wrapper.py:335[0m, in [0;36mJavaEstimator._fit[0;34m(self, dataset)[0m
[1;32m    334[0m [38;5;28;01mdef[39;00m [38;5;21m_fit[39m([38;5;28mself[39m, dataset):
[0;32m--> 335[0m     java_model [38;5;241m=[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_fit_java[49m[43m([49m[43mdataset[49m[43m)[49m
[1;32m    336[0m     model [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39m_create_model(java_model)

File [0;32m~/opt/anaconda3/envs/reco/lib/python3.8/site-packages/pyspark/ml/wrapper.py:332[0m, in [0;36mJavaEstimator._fit_java[0;34m(self, dataset)[0m
[1;32m    331[0m [38;5;28mself[39m[38;5;241m.[39m_transfer_params_to_java()
[0;32m--> 332[0m [38;5;28;01mreturn[39;00m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_java_obj[49m[38;5;241;43m.[39;49m[43mfit[49m[43m([49m[43mdataset[49m[38;5;241;43m.[39;49m[43m_jdf[49m[43m)[49m

File [0;32m~/opt/anaconda3/envs/reco/lib/python3.8/site-packages/py4j/java_gateway.py:1321[0m, in [0;36mJavaMember.__call__[0;34m(self, *args)[0m
[1;32m   1320[0m answer [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39mgateway_client[38;5;241m.[39msend_command(command)
[0;32m-> 1321[0m return_value [38;5;241m=[39m [43mget_return_value[49m[43m([49m
[1;32m   1322[0m [43m    [49m[43manswer[49m[43m,[49m[43m [49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mgateway_client[49m[43m,[49m[43m [49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mtarget_id[49m[43m,[49m[43m [49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mname[49m[43m)[49m
[1;32m   1324[0m [38;5;28;01mfor[39;00m temp_arg [38;5;129;01min[39;00m temp_args:

File [0;32m~/opt/anaconda3/envs/reco/lib/python3.8/site-packages/pyspark/sql/utils.py:111[0m, in [0;36mcapture_sql_exception.<locals>.deco[0;34m(*a, **kw)[0m
[1;32m    110[0m [38;5;28;01mtry[39;00m:
[0;32m--> 111[0m     [38;5;28;01mreturn[39;00m [43mf[49m[43m([49m[38;5;241;43m*[39;49m[43ma[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkw[49m[43m)[49m
[1;32m    112[0m [38;5;28;01mexcept[39;00m py4j[38;5;241m.[39mprotocol[38;5;241m.[39mPy4JJavaError [38;5;28;01mas[39;00m e:

File [0;32m~/opt/anaconda3/envs/reco/lib/python3.8/site-packages/py4j/protocol.py:326[0m, in [0;36mget_return_value[0;34m(answer, gateway_client, target_id, name)[0m
[1;32m    325[0m [38;5;28;01mif[39;00m answer[[38;5;241m1[39m] [38;5;241m==[39m REFERENCE_TYPE:
[0;32m--> 326[0m     [38;5;28;01mraise[39;00m Py4JJavaError(
[1;32m    327[0m         [38;5;124m"[39m[38;5;124mAn error occurred while calling [39m[38;5;132;01m{0}[39;00m[38;5;132;01m{1}[39;00m[38;5;132;01m{2}[39;00m[38;5;124m.[39m[38;5;130;01m\n[39;00m[38;5;124m"[39m[38;5;241m.[39m
[1;32m    328[0m         [38;5;28mformat[39m(target_id, [38;5;124m"[39m[38;5;124m.[39m[38;5;124m"[39m, name), value)
[1;32m    329[0m [38;5;28;01melse[39;00m:

[0;31m<class 'str'>[0m: (<class 'ConnectionRefusedError'>, ConnectionRefusedError(61, 'Connection refused'))

During handling of the above exception, another exception occurred:

[0;31mConnectionRefusedError[0m                    Traceback (most recent call last)
    [0;31m[... skipping hidden 1 frame][0m

File [0;32m~/opt/anaconda3/envs/reco/lib/python3.8/site-packages/IPython/core/interactiveshell.py:1984[0m, in [0;36mInteractiveShell.showtraceback[0;34m(self, exc_tuple, filename, tb_offset, exception_only, running_compiled_code)[0m
[1;32m   1980[0m [38;5;28;01mexcept[39;00m [38;5;167;01mException[39;00m:
[1;32m   1981[0m     stb [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39mInteractiveTB[38;5;241m.[39mstructured_traceback(etype,
[1;32m   1982[0m                         value, tb, tb_offset[38;5;241m=[39mtb_offset)
[0;32m-> 1984[0m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_showtraceback[49m[43m([49m[43metype[49m[43m,[49m[43m [49m[43mvalue[49m[43m,[49m[43m [49m[43mstb[49m[43m)[49m
[1;32m   1985[0m [38;5;28;01mif[39;00m [38;5;28mself[39m[38;5;241m.[39mcall_pdb:
[1;32m   1986[0m     [38;5;66;03m# drop into debugger[39;00m
[1;32m   1987[0m     [38;5;28mself[39m[38;5;241m.[39mdebugger(force[38;5;241m=[39m[38;5;28;01mTrue[39;00m)

File [0;32m~/opt/anaconda3/envs/reco/lib/python3.8/site-packages/ipykernel/zmqshell.py:542[0m, in [0;36mZMQInteractiveShell._showtraceback[0;34m(self, etype, evalue, stb)[0m
[1;32m    536[0m sys[38;5;241m.[39mstdout[38;5;241m.[39mflush()
[1;32m    537[0m sys[38;5;241m.[39mstderr[38;5;241m.[39mflush()
[1;32m    539[0m exc_content [38;5;241m=[39m {
[1;32m    540[0m     [38;5;124m'[39m[38;5;124mtraceback[39m[38;5;124m'[39m : stb,
[1;32m    541[0m     [38;5;124m'[39m[38;5;124mename[39m[38;5;124m'[39m : [38;5;28mstr[39m(etype[38;5;241m.[39m[38;5;18m__name__[39m),
[0;32m--> 542[0m     [38;5;124m'[39m[38;5;124mevalue[39m[38;5;124m'[39m : [38;5;28;43mstr[39;49m[43m([49m[43mevalue[49m[43m)[49m,
[1;32m    543[0m }
[1;32m    545[0m dh [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39mdisplayhook
[1;32m    546[0m [38;5;66;03m# Send exception info over pub socket for other clients than the caller[39;00m
[1;32m    547[0m [38;5;66;03m# to pick up[39;00m

File [0;32m~/opt/anaconda3/envs/reco/lib/python3.8/site-packages/py4j/protocol.py:471[0m, in [0;36mPy4JJavaError.__str__[0;34m(self)[0m
[1;32m    469[0m [38;5;28;01mdef[39;00m [38;5;21m__str__[39m([38;5;28mself[39m):
[1;32m    470[0m     gateway_client [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39mjava_exception[38;5;241m.[39m_gateway_client
[0;32m--> 471[0m     answer [38;5;241m=[39m [43mgateway_client[49m[38;5;241;43m.[39;49m[43msend_command[49m[43m([49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mexception_cmd[49m[43m)[49m
[1;32m    472[0m     return_value [38;5;241m=[39m get_return_value(answer, gateway_client, [38;5;28;01mNone[39;00m, [38;5;28;01mNone[39;00m)
[1;32m    473[0m     [38;5;66;03m# Note: technically this should return a bytestring 'str' rather than[39;00m
[1;32m    474[0m     [38;5;66;03m# unicodes in Python 2; however, it can return unicodes for now.[39;00m
[1;32m    475[0m     [38;5;66;03m# See https://github.com/bartdag/py4j/issues/306 for more details.[39;00m

File [0;32m~/opt/anaconda3/envs/reco/lib/python3.8/site-packages/py4j/java_gateway.py:1036[0m, in [0;36mGatewayClient.send_command[0;34m(self, command, retry, binary)[0m
[1;32m   1015[0m [38;5;28;01mdef[39;00m [38;5;21msend_command[39m([38;5;28mself[39m, command, retry[38;5;241m=[39m[38;5;28;01mTrue[39;00m, binary[38;5;241m=[39m[38;5;28;01mFalse[39;00m):
[1;32m   1016[0m     [38;5;124;03m"""Sends a command to the JVM. This method is not intended to be[39;00m
[1;32m   1017[0m [38;5;124;03m       called directly by Py4J users. It is usually called by[39;00m
[1;32m   1018[0m [38;5;124;03m       :class:`JavaMember` instances.[39;00m
[0;32m   (...)[0m
[1;32m   1034[0m [38;5;124;03m     if `binary` is `True`.[39;00m
[1;32m   1035[0m [38;5;124;03m    """[39;00m
[0;32m-> 1036[0m     connection [38;5;241m=[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_get_connection[49m[43m([49m[43m)[49m
[1;32m   1037[0m     [38;5;28;01mtry[39;00m:
[1;32m   1038[0m         response [38;5;241m=[39m connection[38;5;241m.[39msend_command(command)

File [0;32m~/opt/anaconda3/envs/reco/lib/python3.8/site-packages/py4j/clientserver.py:281[0m, in [0;36mJavaClient._get_connection[0;34m(self)[0m
[1;32m    278[0m     [38;5;28;01mpass[39;00m
[1;32m    280[0m [38;5;28;01mif[39;00m connection [38;5;129;01mis[39;00m [38;5;28;01mNone[39;00m [38;5;129;01mor[39;00m connection[38;5;241m.[39msocket [38;5;129;01mis[39;00m [38;5;28;01mNone[39;00m:
[0;32m--> 281[0m     connection [38;5;241m=[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_create_new_connection[49m[43m([49m[43m)[49m
[1;32m    282[0m [38;5;28;01mreturn[39;00m connection

File [0;32m~/opt/anaconda3/envs/reco/lib/python3.8/site-packages/py4j/clientserver.py:288[0m, in [0;36mJavaClient._create_new_connection[0;34m(self)[0m
[1;32m    284[0m [38;5;28;01mdef[39;00m [38;5;21m_create_new_connection[39m([38;5;28mself[39m):
[1;32m    285[0m     connection [38;5;241m=[39m ClientServerConnection(
[1;32m    286[0m         [38;5;28mself[39m[38;5;241m.[39mjava_parameters, [38;5;28mself[39m[38;5;241m.[39mpython_parameters,
[1;32m    287[0m         [38;5;28mself[39m[38;5;241m.[39mgateway_property, [38;5;28mself[39m)
[0;32m--> 288[0m     [43mconnection[49m[38;5;241;43m.[39;49m[43mconnect_to_java_server[49m[43m([49m[43m)[49m
[1;32m    289[0m     [38;5;28mself[39m[38;5;241m.[39mset_thread_connection(connection)
[1;32m    290[0m     [38;5;28;01mreturn[39;00m connection

File [0;32m~/opt/anaconda3/envs/reco/lib/python3.8/site-packages/py4j/clientserver.py:402[0m, in [0;36mClientServerConnection.connect_to_java_server[0;34m(self)[0m
[1;32m    399[0m [38;5;28;01mif[39;00m [38;5;28mself[39m[38;5;241m.[39mssl_context:
[1;32m    400[0m     [38;5;28mself[39m[38;5;241m.[39msocket [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39mssl_context[38;5;241m.[39mwrap_socket(
[1;32m    401[0m         [38;5;28mself[39m[38;5;241m.[39msocket, server_hostname[38;5;241m=[39m[38;5;28mself[39m[38;5;241m.[39mjava_address)
[0;32m--> 402[0m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43msocket[49m[38;5;241;43m.[39;49m[43mconnect[49m[43m([49m[43m([49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mjava_address[49m[43m,[49m[43m [49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mjava_port[49m[43m)[49m[43m)[49m
[1;32m    403[0m [38;5;28mself[39m[38;5;241m.[39mstream [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39msocket[38;5;241m.[39mmakefile([38;5;124m"[39m[38;5;124mrb[39m[38;5;124m"[39m)
[1;32m    404[0m [38;5;28mself[39m[38;5;241m.[39mis_connected [38;5;241m=[39m [38;5;28;01mTrue[39;00m

[0;31mConnectionRefusedError[0m: [Errno 61] Connection refused
ConnectionRefusedError: [Errno 61] Connection refused

