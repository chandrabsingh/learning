
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Google - Customer story</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="AWS - Financial Services Cloud Symposium - 2022" href="awscloud_financial_symposium_2022.html" />
    <link rel="prev" title="Software Engineering concepts" href="software_engineering_concepts.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/mylogo.png" class="logo" alt="logo">
      
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Welcome
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  System Design
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="intro.html">
   My System Design Book
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="design_patterns.html">
     System Design Summary
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="software_engineering_concepts.html">
     Software Engineering concepts
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Google - Customer story
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="awscloud_financial_symposium_2022.html">
     AWS - Financial Services Cloud Symposium - 2022
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="aws_usecases.html">
     AWS - Customer story
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="design_general_use_cases.html">
     Case study
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="netflix.html">
     Netflix creativity
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="bk_AlexXu_SystemDesignInterview.html">
     Book - System Design Interview - Alex Xu
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="design_patterns_python.html">
     Design Pattern - Python
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Database/Event
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../dbs/intro.html">
   My DB Book
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../dbs/intro_kafka_ksqldb_stream_processing.html">
     Introduction to Kafka/ksqldb/stream processing
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Machine Learning
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../ml_examples/intro.html">
   My ML Book
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../ml_examples/ml_glossary.html">
     ML Conceptual brief
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ml_examples/Store_Sales_Forecasting_With_Tensorflow.html">
     Store Sales Forecasting with TensorFlow
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ml_examples/decision_tree_classification.html">
     Decision Tree - classification
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ml_examples/ml_design_patterns.html">
     The Need for ML Design Patterns
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Deep Learning
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../dl_examples/intro.html">
   My ML Book
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../dl_examples/dl_glossary.html">
     DL Conceptual brief
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../dl_examples/rp_AlexNet.html">
     AlexNet Summary
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../dl_examples/rp_ResNet.html">
     ResNet Summary
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../dl_examples/Anima_Anandkumar_Retrospective_Role_of_Tensors_in_Machine_Learning.html">
     Anima Anandkumar - Retrospective Role of Tensors in ML
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Unix/Shell Scripting
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../unix/intro.html">
   My Unix/Shell Book
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../unix/unix_shell_script.html">
     Unix/Shell FAQs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../unix/my_zshrc.html">
     My .zshrc script
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Reference
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../codes/python_faqs.html">
   Python FAQs
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Lecture Notes
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../cs229_ml/intro.html">
   CS229 ML - by Andrew Ng
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../cs229_ml/lec02-LinearReg-GradientDescent.html">
     Lec 02-Linear Regression - Gradient Descent
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../cs229_ml/lec03-LocallyWeighted-LogisticRegression.html">
     Lec 03-Locally Weighted Regression - Logistic Regression
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../cs229_ml/lec04-Perceptron-GLM.html">
     Lec 04-Perceptron - GLM
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../cs229_ml/lec05-GDA-NaiveBayes.html">
     Lec 05-GDA - Naive Bayes
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../cs229_ml/lec06-NaiveBayes-SVM.html">
     Lec 06-Naive Bayes - SVM
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../cs229_ml/lec07-Kernels-SVM.html">
     Lec 07-Kernels - SVM
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../cs229_ml/lec08-DataSplits-Models-CrossValidation.html">
     Lec 08-Data Splits - Models - Cross Validation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../cs229_ml/lec09-Approx-EstimationError-ERM.html">
     Lec 09-Estimation Error - ERM
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../cs229_ml/lec10-DecisionTrees-EnsembleMethods.html">
     Lec 10-Decision Trees - Ensemble Methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../cs229_ml/lec11-Intro-NN.html">
     Lec 11-Neural Networks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../cs229_ml/lec12-Backpropagation-ImprovingNN.html">
     Lec 12-Improving NN
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../cs229_ml/lec13-DebuggingMLModels-ErrorAnalysis.html">
     Lec 13-Debugging ML Models-Error Analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../cs229_ml/lec14-Expectation-MaximizationAlgo.html">
     Lec 14-Expectation-Maximization Algo
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../cs229_ml/lec15-EMAlgo-FactorAnalysis.html">
     Lec 15-EM Algo-Factor Analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../cs229_ml/lec16-IndependentComponentAnalysis-RL.html">
     Lec 16-Independent Component Analysis-RL
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../cs229_ml/lec17-MDPs-ValuePolicyIteration.html">
     Lec 17-MDPs-Value Policy Iteration
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../cs229_ml/lec18-continuousMDPs-ModelSimulation.html">
     Lec 18-Continuous MDPs-Model Simulation
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/chandrabsingh/learning/master?urlpath=tree/learning/system_design/googlecloud_use_cases.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/chandrabsingh/learning"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/chandrabsingh/learning/issues/new?title=Issue%20on%20page%20%2Fsystem_design/googlecloud_use_cases.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/system_design/googlecloud_use_cases.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#how-do-pokemon-go-scale-to-millions-of-request">
   How do Pokemon Go scale to millions of request
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-does-pokemon-scale">
     How does Pokemon scale?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#was-the-architecture-always-the-same">
     Was the architecture always the same?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-does-the-request-flow-work-when-one-logs-into-pokemon-go">
     How does the request flow work when one logs into Pokemon Go?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#what-happens-when-a-pokemon-is-hunted-and-caught">
     What happens when a Pokemon is hunted and caught?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-is-it-ensured-that-two-people-in-the-same-geographic-location-see-the-same-pokemon-data-and-keep-that-relatively-in-sync-especially-during-the-events">
     How is it ensured that two people in the same geographic location, see the same Pokemon data and keep that relatively in sync, especially during the events?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-does-the-data-pipelines-work-and-what-analytics-happen">
     How does the data pipelines work and what analytics happen?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#as-the-traffic-grows-during-events-how-does-the-data-pipelines-scale">
     As the traffic grows during events, how does the data pipelines scale?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-is-the-health-of-the-system-monitored-during-these-massive-events">
     How is the health of the system monitored during these massive events?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#what-are-the-next-plans">
     What are the next plans?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#references">
     References
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#how-does-uber-scale-to-millions-of-concurrent-requests">
   How does Uber scale to millions of concurrent requests
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#uber-request-flow">
     Uber Request Flow
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#uber-fulfillment-architecture">
     Uber Fulfillment Architecture
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#uber-low-latency-cloud-architecture">
     Uber Low Latency Cloud Architecture
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#uber-auto-scaler">
     Uber Auto scaler
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#uber-on-prem-cache">
     Uber On-prem Cache
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#read">
     READ
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#how-to-create-a-microservice-architecture-with-google-cloud-nylas">
   How to create a microservice architecture with Google Cloud - Nylas
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#legacy-architecture">
     Legacy Architecture
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#current-architecture">
     Current Architecture
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#how-to-architect-an-ai-ml-powered-healthcare-platform-on-google-cloud-vida-health">
   How to architect an AI/ML powered healthcare platform on Google Cloud - Vida Health
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#data-analytics-architecture">
     Data Analytics Architecture
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#web-architecture">
     Web Architecture
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#how-are-the-video-monitoring-system-architectured-arcules">
   How are the video monitoring system architectured - Arcules?
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-does-arcules-work">
     How does Arcules work?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#what-is-video-security-as-a-service">
     What is video security as a service?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#what-is-the-high-level-architecture">
     What is the high level architecture
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#what-type-of-databases-are-used">
     What type of databases are used?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#storing-video-chunks-in-cloud-storage">
     Storing video chunks in cloud storage
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-are-the-ci-cd-microservices-deployed">
     How are the CI/CD microservices deployed
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#cbs-interactive-ai-ml-group">
   CBS Interactive AI/ML Group
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#functional-infrastructure">
     Functional Infrastructure
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#content-awareness-architecture">
     Content Awareness Architecture
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#video-services">
     Video Services
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#recommendations-and-search">
     Recommendations and Search
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Google - Customer story</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#how-do-pokemon-go-scale-to-millions-of-request">
   How do Pokemon Go scale to millions of request
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-does-pokemon-scale">
     How does Pokemon scale?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#was-the-architecture-always-the-same">
     Was the architecture always the same?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-does-the-request-flow-work-when-one-logs-into-pokemon-go">
     How does the request flow work when one logs into Pokemon Go?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#what-happens-when-a-pokemon-is-hunted-and-caught">
     What happens when a Pokemon is hunted and caught?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-is-it-ensured-that-two-people-in-the-same-geographic-location-see-the-same-pokemon-data-and-keep-that-relatively-in-sync-especially-during-the-events">
     How is it ensured that two people in the same geographic location, see the same Pokemon data and keep that relatively in sync, especially during the events?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-does-the-data-pipelines-work-and-what-analytics-happen">
     How does the data pipelines work and what analytics happen?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#as-the-traffic-grows-during-events-how-does-the-data-pipelines-scale">
     As the traffic grows during events, how does the data pipelines scale?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-is-the-health-of-the-system-monitored-during-these-massive-events">
     How is the health of the system monitored during these massive events?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#what-are-the-next-plans">
     What are the next plans?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#references">
     References
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#how-does-uber-scale-to-millions-of-concurrent-requests">
   How does Uber scale to millions of concurrent requests
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#uber-request-flow">
     Uber Request Flow
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#uber-fulfillment-architecture">
     Uber Fulfillment Architecture
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#uber-low-latency-cloud-architecture">
     Uber Low Latency Cloud Architecture
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#uber-auto-scaler">
     Uber Auto scaler
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#uber-on-prem-cache">
     Uber On-prem Cache
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#read">
     READ
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#how-to-create-a-microservice-architecture-with-google-cloud-nylas">
   How to create a microservice architecture with Google Cloud - Nylas
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#legacy-architecture">
     Legacy Architecture
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#current-architecture">
     Current Architecture
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#how-to-architect-an-ai-ml-powered-healthcare-platform-on-google-cloud-vida-health">
   How to architect an AI/ML powered healthcare platform on Google Cloud - Vida Health
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#data-analytics-architecture">
     Data Analytics Architecture
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#web-architecture">
     Web Architecture
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#how-are-the-video-monitoring-system-architectured-arcules">
   How are the video monitoring system architectured - Arcules?
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-does-arcules-work">
     How does Arcules work?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#what-is-video-security-as-a-service">
     What is video security as a service?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#what-is-the-high-level-architecture">
     What is the high level architecture
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#what-type-of-databases-are-used">
     What type of databases are used?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#storing-video-chunks-in-cloud-storage">
     Storing video chunks in cloud storage
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-are-the-ci-cd-microservices-deployed">
     How are the CI/CD microservices deployed
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#cbs-interactive-ai-ml-group">
   CBS Interactive AI/ML Group
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#functional-infrastructure">
     Functional Infrastructure
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#content-awareness-architecture">
     Content Awareness Architecture
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#video-services">
     Video Services
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#recommendations-and-search">
     Recommendations and Search
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="google-customer-story">
<h1>Google - Customer story<a class="headerlink" href="#google-customer-story" title="Permalink to this headline">#</a></h1>
<section id="how-do-pokemon-go-scale-to-millions-of-request">
<h2>How do Pokemon Go scale to millions of request<a class="headerlink" href="#how-do-pokemon-go-scale-to-millions-of-request" title="Permalink to this headline">#</a></h2>
<img src="images/pokemonGo.png">
<section id="how-does-pokemon-scale">
<h3>How does Pokemon scale?<a class="headerlink" href="#how-does-pokemon-scale" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>uses Google cloud - Google Kubernetes Engine and Spanner</p></li>
<li><p>front end service hosted on GKE, as it is easy to scale</p></li>
<li><p>uses 5000 spanner nodes to handle traffic</p></li>
<li><p>uses 1000 GKE nodes just for Pokemon Go service</p></li>
<li><p>uses microservices for gaming augmentations</p></li>
<li><p>millions of players play the same game at any given moment, unlike other multiplayer games like “World of Warcraft” which split players into multiple realms</p></li>
</ul>
</section>
<section id="was-the-architecture-always-the-same">
<h3>Was the architecture always the same?<a class="headerlink" href="#was-the-architecture-always-the-same" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>starting off, it started on Google Data Store</p></li>
<li><p>later it decided to scale</p></li>
<li><p>Spanner was a choice, as it has consistent indexing that allows to do more complex database schemas with primary and secondary keys</p></li>
<li><p>Data store was also non-relational with atomic and durable transactions</p></li>
<li><p>requirement was to have a relational database with full consistency, so Spanner was chosen, which provided global ACID transactions</p></li>
</ul>
</section>
<section id="how-does-the-request-flow-work-when-one-logs-into-pokemon-go">
<h3>How does the request flow work when one logs into Pokemon Go?<a class="headerlink" href="#how-does-the-request-flow-work-when-one-logs-into-pokemon-go" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>when a user catches a Pokemon, a request is received through Google Cloud load balancer</p></li>
<li><p>all static media is stored on Google cloud storage bucket, which is downloaded onto the phone when the app is opened on phone</p></li>
<li><p>the load balancers are cached and served through Google cloud SDN</p></li>
<li><p>when a player catches the Pokemon, the GCLB sends a request to GKE cluster</p></li>
<li><p>there is a front end service that sits behind a Nginx reverse proxy</p></li>
<li><p>the request goes from user phone to reverse proxy to one of these player front end services</p></li>
<li><p>there is a spatial query backend, which a cache by location, which stores information that determines</p>
<ul>
<li><p>where a Pokemon is shown on map,</p></li>
<li><p>where are the gyms</p></li>
<li><p>where are the Pokestops around,</p></li>
<li><p>what is the timezone or any other feature locationwise</p></li>
</ul>
</li>
<li><p>the front end manages the player and their interaction with the game</p></li>
<li><p>the spatial query backend handles the map</p></li>
<li><p>the front end retrieves the information from the squibby to send back to the user</p></li>
<li><p>the spatial query is a custom database that presents the map and the Pokemons</p></li>
</ul>
</section>
<section id="what-happens-when-a-pokemon-is-hunted-and-caught">
<h3>What happens when a Pokemon is hunted and caught?<a class="headerlink" href="#what-happens-when-a-pokemon-is-hunted-and-caught" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>a request is sent from the front end to the Spanner database where player entity is stored in the store</p></li>
<li><p>if someone is battling in the gym or adding lures enhancing Pokestop, that information is stored on spatial query backend</p></li>
<li><p>eventually the data gets consistent, at which point the player will receive the update and then other players in the vicinity will get update as well</p></li>
<li><p>the front end then will retrieve the information from the spatial query backend and send it back to the user</p></li>
<li><p>this information is also stored using protobuf into Bigtable</p></li>
<li><p>Bigtable is also used for logging and tracking purposes</p></li>
<li><p>Pub/Sub is also used to send topic which is then used for analytics pipeline</p></li>
</ul>
</section>
<section id="how-is-it-ensured-that-two-people-in-the-same-geographic-location-see-the-same-pokemon-data-and-keep-that-relatively-in-sync-especially-during-the-events">
<h3>How is it ensured that two people in the same geographic location, see the same Pokemon data and keep that relatively in sync, especially during the events?<a class="headerlink" href="#how-is-it-ensured-that-two-people-in-the-same-geographic-location-see-the-same-pokemon-data-and-keep-that-relatively-in-sync-especially-during-the-events" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>everything in the servers are deterministic</p></li>
<li><p>if they are in same locations, both the players will get returned the same details</p></li>
<li><p>this is achieved using caching which manages precise timing especially when the settings are changed and they need to be in sync across all servers</p></li>
</ul>
</section>
<section id="how-does-the-data-pipelines-work-and-what-analytics-happen">
<h3>How does the data pipelines work and what analytics happen?<a class="headerlink" href="#how-does-the-data-pipelines-work-and-what-analytics-happen" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>about 10G of data is generated daily and stored in BigQuery</p></li>
<li><p>this data is utilized by data science team</p></li>
<li><p>this is used for marketing purposes, for verification</p></li>
<li><p>Dataflow is used to run batch jobs to process the player logs sitting in Bigtable</p></li>
<li><p>this is used for cheat detection</p>
<ul>
<li><p>a player in Japan and a minute later they were in Australia</p></li>
<li><p>check for such logs and respond to improper player signals</p></li>
</ul>
</li>
<li><p>Google Dataflow is also used to set up Pokestops and gyms and habitat information around the world</p></li>
<li><p>information from various sources are used, like OpenStreetMap, US Geological survey and WayFarer, a crowdsourced website, for players to submit points of interests in their neighborhood and combine all that information to build a living map of the world</p></li>
</ul>
</section>
<section id="as-the-traffic-grows-during-events-how-does-the-data-pipelines-scale">
<h3>As the traffic grows during events, how does the data pipelines scale?<a class="headerlink" href="#as-the-traffic-grows-during-events-how-does-the-data-pipelines-scale" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>with the increase of transactions in pipelines, is managed by BigQuery</p>
<ul>
<li><p>BigQuery’s serverless architecture decouples storage and compute and allows them to scale independently on demand</p></li>
</ul>
</li>
<li><p>scaling works premptively on Google cloud to support the traffic</p></li>
</ul>
</section>
<section id="how-is-the-health-of-the-system-monitored-during-these-massive-events">
<h3>How is the health of the system monitored during these massive events?<a class="headerlink" href="#how-is-the-health-of-the-system-monitored-during-these-massive-events" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>multiple monitoring systems like Prometheus, Grafana, and Google Cloud Monitoring is used</p></li>
</ul>
</section>
<section id="what-are-the-next-plans">
<h3>What are the next plans?<a class="headerlink" href="#what-are-the-next-plans" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>exploring Agones and Google Game Servers</p></li>
</ul>
</section>
<section id="references">
<h3>References<a class="headerlink" href="#references" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://www.scaleyourapp.com/distributed-systems-scalability-part1-heroku-client-rate-throttling/">https://www.scaleyourapp.com/distributed-systems-scalability-part1-heroku-client-rate-throttling/</a></p></li>
<li><p><a class="reference external" href="https://cloud.google.com/blog/topics/developers-practitioners/how-pok%C3%A9mon-go-scales-millions-requests">https://cloud.google.com/blog/topics/developers-practitioners/how-pokémon-go-scales-millions-requests</a></p></li>
</ul>
</section>
</section>
<section id="how-does-uber-scale-to-millions-of-concurrent-requests">
<h2>How does Uber scale to millions of concurrent requests<a class="headerlink" href="#how-does-uber-scale-to-millions-of-concurrent-requests" title="Permalink to this headline">#</a></h2>
<section id="uber-request-flow">
<h3>Uber Request Flow<a class="headerlink" href="#uber-request-flow" title="Permalink to this headline">#</a></h3>
<img src="./images/uberRequestFlow.png">
<ul class="simple">
<li><p>Fulfillment platform</p>
<ul>
<li><p>goes through series of checks and balances and then triggers fulfillment to create new order for consumer</p></li>
<li><p>order is the intent of consumer</p></li>
<li><p>intent is then translated into jobs that needs to be processed</p></li>
<li><p>this information is stored in spanner</p></li>
<li><p>these jobs are read by matching engine</p></li>
<li><p>offered to any open provider or supplier nearby</p></li>
<li><p>earlier all of this data was saved in <strong>on-prem database</strong> and recently moved to <strong>Spanner</strong></p></li>
</ul>
</li>
<li><p>Challenges with on-prem database</p>
<ul>
<li><p>No-SQL storage engine <strong>Cassandra</strong> was used to save all real time fulfillment entities</p></li>
<li><p>to maintain serializability on top of Cassandra, <strong>Ringpop</strong> was used to provide individual <strong>entity-level serialization</strong></p></li>
<li><p>Challenges with NoSQL</p>
<ul>
<li><p>Cassandra follows the principle of <strong>eventual consistency</strong></p></li>
<li><p>there is <strong>no guarantee of low-latency quorum writes with Cassandra</strong></p></li>
<li><p>witnessed complex storage interactions that required multi-row and multi-table writes.</p></li>
<li><p>to tackle this, an application layer framework was build to orchestrate this operation using saga pattern</p></li>
<li><p>these inconsistencies had to be manually corrected</p></li>
<li><p>in real world - two different drivers are dispatched to a customer</p></li>
</ul>
</li>
<li><p>Horizontal scaling bottlenecks were observed in overall architecture</p>
<ul>
<li><p>this was primarily because how application layer was sharded with Ringpop</p></li>
<li><p>properties of traditional SQL-based storage ACID guarantees were observed</p></li>
<li><p>consistency was the primary requirement</p></li>
<li><p>NoSQL requirements with strong ACID guarantees were needed</p></li>
</ul>
</li>
</ul>
</li>
<li><p>Google Spanner was the solution</p>
<ul>
<li><p>what were the explorations for transitioning from NoSQL to NewSQL</p>
<ul>
<li><p>Consistency with high resilency and availability were the requirement criterias</p></li>
<li><p>CockroachDB, FoundationDB and Cloud Spanner were considered</p></li>
<li><p>functional requirements were fulfilled</p>
<ul>
<li><p>scaled horizontally with our benchmarks, and provided a managed solution for cluster management and maintenance</p></li>
</ul>
</li>
<li><p>what is the new architecture</p>
<ul>
<li><p>every user request results in a transaction against one or more rows and across one or more tables in cloud Spanner</p></li>
<li><p>consistent view of data is available both to internal and external customers</p></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</section>
<section id="uber-fulfillment-architecture">
<h3>Uber Fulfillment Architecture<a class="headerlink" href="#uber-fulfillment-architecture" title="Permalink to this headline">#</a></h3>
<img src="./images/uberNewFulfillmentArchitecture.png">
<ul class="simple">
<li><p>latency is the biggest factor, what is the networking architecture looks like</p>
<ul>
<li><p>resilient and highly reliable infrastructure to support Uber’s workload</p></li>
<li><p>networking infrastructure was divided into 2 major components</p>
<ul>
<li><p>physical layer consisting of interconnections between Uber and Cloud vendors</p></li>
<li><p>logical layer consisting of virtual connections on top of physical layer to achieve redundancy</p>
<ul>
<li><p>this is achieved by making multiple routers and having local access points at each physical network route</p></li>
<li><p>leverage Google’s private Google access to route using cloud interconnect VLAN attachments</p></li>
<li><p>reduced the need of routing traffic through public internet and provided additional reliability</p></li>
<li><p>benchmarking tests were designed</p></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</section>
<section id="uber-low-latency-cloud-architecture">
<h3>Uber Low Latency Cloud Architecture<a class="headerlink" href="#uber-low-latency-cloud-architecture" title="Permalink to this headline">#</a></h3>
<img src="./images/uberLowLatencyNetwork.png">
<ul class="simple">
<li><p>how was the migration and transition made seemless</p>
<ul>
<li><p>database topology was significant different from old platform, any kind of live migration of data was ruled out</p></li>
<li><p>most of the data is ephemeral and changing continuously, backups would have resulted in loss of data</p></li>
<li><p>systems were built that will intercept request from user session and attach to the new user session</p></li>
<li><p>till the past order is not complete, this migration is not done</p></li>
<li><p>only open user session with no active orders were migrated to new architecture</p></li>
<li><p>tooling were tested rigorously in testing, staging and shadow environments</p></li>
<li><p>test cities were developed to check migrations with one city at a time</p></li>
<li><p>continuously migrate over 6 month period</p></li>
</ul>
</li>
<li><p>Performance Optimization</p>
<ul>
<li><p>networking stack</p>
<ul>
<li><p>TCP Reset</p>
<ul>
<li><p>the spanner session needs to be re-established for the forwarded requests</p></li>
<li><p>by optimizing gRPC channel pool whenever a channel is affected by TCP resets, requests are automatically forwarded temporarily to backup empty gRPC channel</p></li>
</ul>
</li>
<li><p>Intermittent packet loss</p>
<ul>
<li><p>with frequent health checks, broken TCP connections can be detected within 5 sec and graceful connections can be triggered</p></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>To take advantage of cloud Spanner elasticity, autoscaler was built</p>
<ul>
<li><p>constantly tunes the number of nodes based on CPU utilization target</p></li>
<li><p>as traffic is variable based on constant CPU utilization target, maximum elasticity is achieved from Cloud spanner cluster</p></li>
</ul>
</li>
</ul>
</section>
<section id="uber-auto-scaler">
<h3>Uber Auto scaler<a class="headerlink" href="#uber-auto-scaler" title="Permalink to this headline">#</a></h3>
<img src="./images/uberAutoscaler.png">
<ul class="simple">
<li><p>On-prem cache was made to handle workload which is very read-heavy</p>
<ul>
<li><p>improves latency and cost</p></li>
<li><p>only route stale reads to Spanner</p></li>
<li><p>allow cache to serve snapshot isolation based on Spanner’s queue time</p></li>
</ul>
</li>
</ul>
</section>
<section id="uber-on-prem-cache">
<h3>Uber On-prem Cache<a class="headerlink" href="#uber-on-prem-cache" title="Permalink to this headline">#</a></h3>
<img src="./images/uberOnpremcache.png">
</section>
<section id="read">
<h3>READ<a class="headerlink" href="#read" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>“How Ringpop from Uber Engineering helps distribute your application”</p></li>
<li><p>Saga pattern - in microservices architecture it tracks all events of distributed transactions as a sequence and decides the rollbacks events in case of a failure</p></li>
<li><p>Planet scale</p></li>
<li><p>Strong read and Stale read</p></li>
</ul>
</section>
</section>
<section id="how-to-create-a-microservice-architecture-with-google-cloud-nylas">
<h2>How to create a microservice architecture with Google Cloud - Nylas<a class="headerlink" href="#how-to-create-a-microservice-architecture-with-google-cloud-nylas" title="Permalink to this headline">#</a></h2>
<section id="legacy-architecture">
<h3>Legacy Architecture<a class="headerlink" href="#legacy-architecture" title="Permalink to this headline">#</a></h3>
<img src="./images/nylasOldArchitecture.png">
<ul class="simple">
<li><p>Workflow Automation</p>
<ul>
<li><p>by collecting data from multiple applications</p></li>
<li><p>compiling insights</p></li>
<li><p>create end-to-end automation workflow</p></li>
</ul>
</li>
<li><p>handle communication data driving business process automation</p></li>
<li><p>Problems to tackle</p>
<ul>
<li><p>security</p></li>
<li><p>scalability</p></li>
<li><p>performance</p></li>
<li><p>cost</p></li>
</ul>
</li>
<li><p>Why Google Cloud</p>
<ul>
<li><p>best distributed technology</p></li>
<li><p>GKE - Google Kubernetes Engine is the best cloud provider to run Kubernetes workload securely at scale</p></li>
<li><p>one of the most performant data stores in Spanner</p></li>
</ul>
</li>
<li><p>Architecture</p>
<ul>
<li><p>the advantage of using <strong>GKE</strong> is its ability to <strong>handle the container orchestration</strong>, <strong>Cloud Pub/Sub for message bus</strong> and <strong>Cloud Spanner for relational data store</strong></p></li>
<li><p>Spanner processes 1B requests per second at peak</p></li>
<li><p>latency of less than 7 milliseconds</p></li>
<li><p>GCP services are very robust</p></li>
</ul>
</li>
<li><p>Transition</p>
<ul>
<li><p>from Python based application to Go - code rewrite</p>
<ul>
<li><p>services were rewritten in Go</p></li>
<li><p>10x throughput improvement was observed</p></li>
</ul>
</li>
<li><p>move from virtual machine instances on AWS EC2 to GKE</p>
<ul>
<li><p>move the orchestration from <strong>AWS autoscaler group to GKE</strong></p></li>
<li><p>GKE was used to orchestrate containers</p></li>
<li><p>due to security reasons, nodes have to be cycled very quickly</p></li>
<li><p>were able to have upto 15000 nodes in Kubernetes cluster</p></li>
<li><p>other cloud providers dont provide this level of support</p></li>
<li><p><strong>gVisor</strong> is used to run containers to create strong isolation between application and operating system</p></li>
<li><p>helps lock down host memory and storage access and enforce least permission principle at operating system level</p></li>
<li><p><strong>gVisor is an application kernel</strong>, written in Go, that implements substantial portion of Linux system call interface. It provides an additional layer of isolation between running applications and host operating system</p></li>
</ul>
</li>
</ul>
</li>
<li><p>20TB of data processing in MySQL shards</p>
<ul>
<li><p>Cloud spanner was used to keep application states</p></li>
<li><p>store keys for each accounts that needs to be connected</p></li>
<li><p>fast read/write is extremely critical for large number of calls</p></li>
<li><p>high performance to have predictable end-to-end latency</p></li>
</ul>
</li>
</ul>
</section>
<section id="current-architecture">
<h3>Current Architecture<a class="headerlink" href="#current-architecture" title="Permalink to this headline">#</a></h3>
<img src="./images/nylasNewArchitecture.png">
<ul class="simple">
<li><p>PII(Personally Identifiable Information)</p>
<ul>
<li><p>Nylas does not have to hold PII</p></li>
<li><p>for security services</p></li>
</ul>
</li>
<li><p>Migrated from database centric design to event based design</p>
<ul>
<li><p>message bus is the heart of all application</p></li>
<li><p>to make this transition, Google Pub/Sub was choosen</p></li>
<li><p>Google Pub/Sub allows services to communicate asynchronously with latencies on the order of 100 milliseconds</p></li>
<li><p>in legacy AWS architecture which was more of data driven architecture</p>
<ul>
<li><p>the data is written into <strong>Dynamo</strong></p></li>
<li><p>then gets converted by <strong>lambda function</strong></p></li>
<li><p>then goes to <strong>Kinesis event stream</strong></p></li>
</ul>
</li>
<li><p>in new architecture, this is simplified</p>
<ul>
<li><p>event it first</p></li>
<li><p>rewrote it directly on Google Pub/Sub</p></li>
<li><p>puts lot of strain on system, with trust that this will get scale and perform reliably and consistently</p></li>
<li><p>on <strong>Google Pub/Sub, the performance latency is minimal</strong></p></li>
<li><p>event bus can act as data store</p></li>
</ul>
</li>
</ul>
</li>
<li><p>Benefits of migrating</p>
<ul>
<li><p><strong>30 times performance on each node</strong> was observed</p></li>
<li><p><strong>Elasticity of architecture</strong> is amazing</p></li>
</ul>
</li>
</ul>
</section>
</section>
<section id="how-to-architect-an-ai-ml-powered-healthcare-platform-on-google-cloud-vida-health">
<h2>How to architect an AI/ML powered healthcare platform on Google Cloud - Vida Health<a class="headerlink" href="#how-to-architect-an-ai-ml-powered-healthcare-platform-on-google-cloud-vida-health" title="Permalink to this headline">#</a></h2>
<section id="data-analytics-architecture">
<h3>Data Analytics Architecture<a class="headerlink" href="#data-analytics-architecture" title="Permalink to this headline">#</a></h3>
<img src="./images/vidaDataAnalyticsArchitecture.png">
<ul class="simple">
<li><p>provides comprehensive virtual care solution tailored to personalized health goals and preferences</p></li>
<li><p>what are the challenges in building such application</p>
<ul>
<li><p>data coming from different sources of different types</p></li>
<li><p>needs to be integrated seemlessly</p></li>
<li><p>both for mobile and web users</p></li>
</ul>
</li>
<li><p>Why Google cloud</p>
<ul>
<li><p>50% cost reduction</p></li>
<li><p>developer productivity, one single place to look at</p></li>
<li><p>focus on AI/ML</p></li>
</ul>
</li>
<li><p>Challenges with ML and AI</p>
<ul>
<li><p>make provider more efficient at their jobs</p></li>
<li><p>use NLP and speech to text - take down notes for doctors/assistants</p></li>
<li><p>how to get more patients</p>
<ul>
<li><p>depending on severity and acuity of patients</p></li>
<li><p>give signals to providers</p></li>
<li><p>prioritize such cases</p></li>
</ul>
</li>
</ul>
</li>
<li><p>Vidapedia - major recommendation platform - using Workspace and BigQuery. How does it work?</p>
<ul>
<li><p>Vidapedia</p>
<ul>
<li><p>set of protocols, as Google docs, written to help providers/clinicians</p></li>
<li><p>200 different protocols are created, not feasible to remember/memorize</p></li>
<li><p>how to get such information at high speed</p></li>
</ul>
</li>
<li><p>Vidapedia recommendation system does on machine learning</p>
<ul>
<li><p>look into patient-provider interaction going on</p></li>
<li><p>surface right protocol for such interaction</p></li>
<li><p>ML model detects and triggers particular protocol during or after the session</p></li>
<li><p>provider is able to give right care to patient</p></li>
</ul>
</li>
<li><p>this was possible using Google Doc protocols interaction with Google Workspace</p>
<ul>
<li><p>use this data, index them</p></li>
<li><p>store it in BigQuery</p></li>
<li><p>build ML tools on top of that</p></li>
</ul>
</li>
</ul>
</li>
<li><p>Data pipeline architecture</p>
<ul>
<li><p>data comes from different sources</p></li>
<li><p>providers provide consultation notes</p></li>
<li><p>derive insights</p></li>
<li><p>data gets ingested both in relational and unstructured format</p></li>
<li><p>all these data is saved in BigQuery</p></li>
<li><p>which is then used in analytics application deriving insights</p></li>
<li><p>visualization tools such as data studio and looker</p></li>
<li><p>ml models are built which is then sourced into visualization tools</p></li>
<li><p>exploration in terms of VertexAI for quickly building these models and deploying them</p></li>
</ul>
</li>
<li><p>Transformations</p>
<ul>
<li><p>in past custom ETL pipelines were designed, which is a challenge</p></li>
<li><p>currently <strong>dbt</strong> is used for transformations</p></li>
</ul>
</li>
<li><p>how is the orchestration done</p>
<ul>
<li><p><strong>Cloud Composer</strong> is used for orchestration the pipeline, scheduling all of this ingest, processing data, and running all the stuff</p></li>
</ul>
</li>
<li><p>how is security requirement resolved</p>
<ul>
<li><p>patient data is very sensitive</p></li>
<li><p>stringent privacy laws</p></li>
<li><p>use <strong>Google Data Loss Protection(DLP)</strong></p></li>
<li><p><strong>mask PII data</strong></p></li>
<li><p>reduce surface area</p></li>
</ul>
</li>
<li><p>what is the Web Architecture designed</p>
<ul>
<li><p>SADA practices - well known in the industry</p></li>
<li><p>standard 3-tier architecture</p></li>
<li><p>load balancers at the front</p></li>
<li><p>deployed in Google Kubernetes engine</p></li>
<li><p>middle API layer that returns all the request response</p></li>
<li><p>at the end there is GCS Postgres database, scaling is easy</p></li>
<li><p>easy to scale</p></li>
</ul>
</li>
</ul>
</section>
<section id="web-architecture">
<h3>Web Architecture<a class="headerlink" href="#web-architecture" title="Permalink to this headline">#</a></h3>
<img src="./images/vidaWebArchitecture.png">
<ul class="simple">
<li><p>What next</p>
<ul>
<li><p>Google Cloud Healthcare API</p>
<ul>
<li><p>provides managed solution for storing and accessing healthcare data in Google cloud</p></li>
</ul>
</li>
<li><p>Google FHIR - Fast Healthcare Interoperability Resources</p>
<ul>
<li><p>Explore and integrate google health services and api</p></li>
</ul>
</li>
</ul>
</li>
</ul>
</section>
</section>
<section id="how-are-the-video-monitoring-system-architectured-arcules">
<h2>How are the video monitoring system architectured - Arcules?<a class="headerlink" href="#how-are-the-video-monitoring-system-architectured-arcules" title="Permalink to this headline">#</a></h2>
<section id="how-does-arcules-work">
<h3>How does Arcules work?<a class="headerlink" href="#how-does-arcules-work" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>Arcules takes information from multitude of IoT devices, captures it, processes it and then pushes it into the Google cloud</p></li>
</ul>
<img src="images/arculesArch.png">
</section>
<section id="what-is-video-security-as-a-service">
<h3>What is video security as a service?<a class="headerlink" href="#what-is-video-security-as-a-service" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>it is like a SaaS based product, that is storing videos. Its competitors are video management services(VMS)</p></li>
<li><p>the collected vides help finding incidences or people within video, all captured in cameras</p></li>
</ul>
</section>
<section id="what-is-the-high-level-architecture">
<h3>What is the high level architecture<a class="headerlink" href="#what-is-the-high-level-architecture" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>the customers have a small appliance at the edge that allows buffering information before sending it to the cloud</p></li>
<li><p>it can be deployed inside of bare metal or VMware</p></li>
<li><p>Kubernetes allows deploying multiple containers</p></li>
<li><p>last mile piece - allows near zero latency</p></li>
<li><p>have 90 microservices in GKE</p></li>
<li><p>different types of load balancers are used as HTTP/HTTPS and endpoint connections, along with instances of L4 with WebRTC</p></li>
<li><p>also use IoT core, which is used for metadata that flows up through some the services at the edge, which gets fed into pub/sub, which then gets fed into BigQuery</p></li>
</ul>
</section>
<section id="what-type-of-databases-are-used">
<h3>What type of databases are used?<a class="headerlink" href="#what-type-of-databases-are-used" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>different types of dbs are used</p></li>
<li><p>use cloud SQL, both Postgres and a bit of MySQL</p></li>
<li><p>graph database like Arango is used for NIST based permission graph, which makes permission way better for horizontally scaling</p></li>
<li><p>Singlestore is used for high rate of ingestion, with 400,000 inserts per second</p></li>
<li><p>Postgres is mostly used for device configuration storage</p></li>
<li><p>BigQuery is used for slow storage, which is powerful to run jobs across large datasets</p></li>
</ul>
</section>
<section id="storing-video-chunks-in-cloud-storage">
<h3>Storing video chunks in cloud storage<a class="headerlink" href="#storing-video-chunks-in-cloud-storage" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>videos are stored today inside of custom container format H.264</p></li>
<li><p>every videos have keyframes</p></li>
<li><p>these keyframes are chunked up, depending on the camera, will be one, two or four second</p></li>
<li><p>these informations are aggregated up, so that no extra spending is required on PUT requests</p></li>
<li><p>all the messages fly through pub/sub</p></li>
</ul>
</section>
<section id="how-are-the-ci-cd-microservices-deployed">
<h3>How are the CI/CD microservices deployed<a class="headerlink" href="#how-are-the-ci-cd-microservices-deployed" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>deployment is typically through Seneca, with build process through the cloud build platform</p></li>
<li><p>heavy users of container services for container management</p></li>
</ul>
</section>
</section>
<section id="cbs-interactive-ai-ml-group">
<h2>CBS Interactive AI/ML Group<a class="headerlink" href="#cbs-interactive-ai-ml-group" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://youtu.be/hX71H78UYAc">https://youtu.be/hX71H78UYAc</a></p></li>
</ul>
<section id="functional-infrastructure">
<h3>Functional Infrastructure<a class="headerlink" href="#functional-infrastructure" title="Permalink to this headline">#</a></h3>
<img src="images/googleFunctionalInfra.png">
</section>
<section id="content-awareness-architecture">
<h3>Content Awareness Architecture<a class="headerlink" href="#content-awareness-architecture" title="Permalink to this headline">#</a></h3>
<img src="images/googleContentAwarenessProduct.png">
</section>
<section id="video-services">
<h3>Video Services<a class="headerlink" href="#video-services" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>the video narratives are broken down into</p>
<ul>
<li><p>foreground information that drives the story forward</p></li>
<li><p>background information that provides the setting</p></li>
</ul>
</li>
</ul>
<img src="images/googleFunctionalInfra.png">
</section>
<section id="recommendations-and-search">
<h3>Recommendations and Search<a class="headerlink" href="#recommendations-and-search" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>goal - general purpose recommendations to brands with simple API interface</p></li>
<li><p>accomplished dynamically using Redis</p>
<ul>
<li><p>recommendation combination at request time is fast</p></li>
<li><p>backend failures only result in delays in updating recommendations</p></li>
</ul>
</li>
</ul>
<img src="images/googleGenReco.png"><ul class="simple">
<li><p>these recommendation models must generate new recommendations without fear of breaking</p></li>
<li><p>the front end of these recommendation models must be distinctly different from the backend of already generated recommendations</p>
<ul>
<li><p>applying business logic on one and not the other</p></li>
</ul>
</li>
<li><p>goal is to serve the best recommendation at any given time</p></li>
<li><p>Google cloud endpoints play a crucial role in this</p>
<ul>
<li><p>it handles authentication, monitoring as well as giving us a central place for API documentation</p></li>
</ul>
</li>
<li><p>Admiral decides what recommendations are selected and what recommendations are returned</p>
<ul>
<li><p>this is the only choke point for reliability</p></li>
<li><p>Admiral servees using JSON blobs</p></li>
<li><p>business logics can be easily changed in Admiral</p></li>
</ul>
</li>
<li><p>The ingest process starts with Trawler, which sources data into the content awareness system</p></li>
<li><p>this is then augmented with Cloud AI APIs and store it</p></li>
<li><p>GenReco is three cron jobs, which is an auto-scaling worker service</p></li>
<li><p>Data collector sources data from content awareness system which is augmented with the output of the cloud AI APIs</p>
<ul>
<li><p>it stores it in GenReco in a format that can be used</p></li>
</ul>
</li>
<li><p>If every piece of compared against every other piece of content, it will be an intractable problem with lots of resources and many useless comparisons. GenReco submit helps in this</p>
<ul>
<li><p>first step is a filter to identify based on some initial processing, content that is most likely to be recommended</p></li>
<li><p>they are then submitted as jobs to auto-scaling workers</p></li>
<li><p>these workers then compute the actual similarity metrics</p></li>
<li><p>they can then scale up when the content creation is high and scale down when no content is coming through</p></li>
</ul>
</li>
<li><p>the last step is GenReco where the recommendations are actually created</p>
<ul>
<li><p>all the comparisons are pulled that are computed by workers</p></li>
<li><p>generate the best recommendations of that particular time</p></li>
</ul>
</li>
<li><p>the recommendations can have score, order, weight, interleaving</p></li>
<li><p>all this is required is to have models in Redis, which can be combined dynamically</p></li>
</ul>
<img src="images/googleFutureDirection.png"></section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./system_design"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="software_engineering_concepts.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Software Engineering concepts</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="awscloud_financial_symposium_2022.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">AWS - Financial Services Cloud Symposium - 2022</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Chandra<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>