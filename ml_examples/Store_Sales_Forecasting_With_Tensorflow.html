
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Store Sales Forecasting with TensorFlow</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Decision Tree - classification" href="decision_tree_classification.html" />
    <link rel="prev" title="ML Conceptual brief" href="ml_glossary.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/mylogo.png" class="logo" alt="logo">
      
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   Welcome
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  System Design
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../system_design/intro.html">
   My System Design Book
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../system_design/design_patterns.html">
     System Design Summary
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../system_design/software_engineering_concepts.html">
     Software Engineering concepts
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../system_design/googlecloud_use_cases.html">
     Google - Customer story
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../system_design/awscloud_financial_symposium_2022.html">
     AWS - Financial Services Cloud Symposium - 2022
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../system_design/aws_usecases.html">
     AWS - Customer story
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../system_design/design_general_use_cases.html">
     Case study
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../system_design/netflix.html">
     Netflix creativity
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../system_design/bk_AlexXu_SystemDesignInterview.html">
     Book - System Design Interview - Alex Xu
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../system_design/design_patterns_python.html">
     Design Pattern - Python
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../cloud/intro.html">
   My Cloud Book
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../cloud/aws_cloud_components.html">
     AWS cloud components
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Code
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../codes/intro.html">
   My Code Book
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../codes/python_faqs.html">
     Python FAQs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../algos/all_algos.html">
     Coding Challenges
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../codes/python_data_analytics.html">
     Python Data Analytics - FAQs
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Database/Event
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../dbs/intro.html">
   My DB Book
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../dbs/intro_kafka_ksqldb_stream_processing.html">
     Introduction to Kafka/ksqldb/stream processing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../dbs/neo4j_basics.html">
     Building Neo4j Applications with Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../dbs/neo4j_graph_datascience.html">
     Game of Thrones - Knowledge Graph analysis using Neo4j
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Math
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../maths/intro.html">
   My Math Book
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../maths/probability_simulations.html">
     Probability Games using Simulations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../maths/linear_algebra.html">
     Linear Algebra - FAQs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../maths/probabilistic_programming.html">
     Getting started with PyMC3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../maths/causal_inference_learning.html">
     Causal Inference Learning
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../econometrics/SARIMA_modeling.html">
     SARIMA modeling
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Machine Learning
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="intro.html">
   My ML Book
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="ml_glossary.html">
     ML Conceptual brief
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Store Sales Forecasting with TensorFlow
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="decision_tree_classification.html">
     Decision Tree - classification
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ml_design_patterns.html">
     Machine Learning Design Patterns
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../dl_examples/intro.html">
   My DL Book
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../dl_examples/dl_glossary.html">
     DL Conceptual brief
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../dl_examples/rp_AlexNet.html">
     AlexNet Summary
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../dl_examples/rp_ResNet.html">
     ResNet Summary
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../dl_examples/Anima_Anandkumar_Retrospective_Role_of_Tensors_in_Machine_Learning.html">
     Anima Anandkumar - Retrospective Role of Tensors in ML
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../recommenders/intro.html">
   My Recommenders Book
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../recommenders/als_deep_dive.html">
     Spark Collaborative Filtering (ALS) Deep Dive
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../rl_examples/intro.html">
   My RL Book
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../rl_examples/mab_ts_ab.html">
     Multi-armed bandit problem
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Shell Scripting
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../unix/intro.html">
   My Unix/Shell Book
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../unix/unix_shell_script.html">
     Unix/Shell FAQs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../unix/my_zshrc.html">
     My .zshrc script
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Lecture Notes
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../cs229_ml/intro.html">
   CS229 ML - by Andrew Ng
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
  <label for="toctree-checkbox-11">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../cs229_ml/lec02-LinearReg-GradientDescent.html">
     Lec 02-Linear Regression - Gradient Descent
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../cs229_ml/lec03-LocallyWeighted-LogisticRegression.html">
     Lec 03-Locally Weighted Regression - Logistic Regression
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../cs229_ml/lec04-Perceptron-GLM.html">
     Lec 04-Perceptron - GLM
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../cs229_ml/lec05-GDA-NaiveBayes.html">
     Lec 05-GDA - Naive Bayes
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../cs229_ml/lec06-NaiveBayes-SVM.html">
     Lec 06-Naive Bayes - SVM
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../cs229_ml/lec07-Kernels-SVM.html">
     Lec 07-Kernels - SVM
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../cs229_ml/lec08-DataSplits-Models-CrossValidation.html">
     Lec 08-Data Splits - Models - Cross Validation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../cs229_ml/lec09-Approx-EstimationError-ERM.html">
     Lec 09-Estimation Error - ERM
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../cs229_ml/lec10-DecisionTrees-EnsembleMethods.html">
     Lec 10-Decision Trees - Ensemble Methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../cs229_ml/lec11-Intro-NN.html">
     Lec 11-Neural Networks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../cs229_ml/lec12-Backpropagation-ImprovingNN.html">
     Lec 12-Improving NN
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../cs229_ml/lec13-DebuggingMLModels-ErrorAnalysis.html">
     Lec 13-Debugging ML Models-Error Analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../cs229_ml/lec14-Expectation-MaximizationAlgo.html">
     Lec 14-Expectation-Maximization Algo
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../cs229_ml/lec15-EMAlgo-FactorAnalysis.html">
     Lec 15-EM Algo-Factor Analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../cs229_ml/lec16-IndependentComponentAnalysis-RL.html">
     Lec 16-Independent Component Analysis-RL
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../cs229_ml/lec17-MDPs-ValuePolicyIteration.html">
     Lec 17-MDPs-Value Policy Iteration
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../cs229_ml/lec18-continuousMDPs-ModelSimulation.html">
     Lec 18-Continuous MDPs-Model Simulation
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../cs224w_ml_graph/intro.html">
   CS224W: Machine Learning with Graphs - by Jure Leskovev
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
  <label for="toctree-checkbox-12">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../cs224w_ml_graph/lec01_Introduction_MLforGraphs.html">
     L01: Introduction ML for Graphs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../cs224w_ml_graph/lec02-TraditionalMethods.html">
     L02: Traditional Methods for ML in Graphs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../cs224w_ml_graph/CS224W_Colab_0.html">
     <strong>
      HW0
     </strong>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../cs224w_ml_graph/CS224W_Colab_1.html">
     HW1
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../ee364a_co1/intro.html">
   EE364A: Convex Optimization 1 - by Stephen Boyd
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
  <label for="toctree-checkbox-13">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../ee364a_co1/lec01-Introduction.html">
     Lecture 1 - Introduction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ee364a_co1/lec02-ConvexSets.html">
     Lecture 2 - Convex Sets
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Language Notes
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../jpn/intro.html">
   My Japanese Book
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
  <label for="toctree-checkbox-14">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../jpn/learnJapanese.html">
     Japanese phrases in Hindi and English
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/ml_examples/Store_Sales_Forecasting_With_Tensorflow.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/chandrabsingh/learning"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/chandrabsingh/learning/issues/new?title=Issue%20on%20page%20%2Fml_examples/Store_Sales_Forecasting_With_Tensorflow.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/chandrabsingh/learning/master?urlpath=tree/learning/ml_examples/Store_Sales_Forecasting_With_Tensorflow.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#preliminary-data-analysis">
   Preliminary Data Analysis
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-dataset">
     The Dataset
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#missing-features">
     Missing Features
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dropping-features">
     Dropping Features
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#filling-in-data">
     Filling in Data
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#merging-data">
     Merging Data
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#categorical-data">
     Categorical Data
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plot-data">
     1. Plot data
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data-processing">
   1. Data Processing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#splitting-datasets">
     1. Splitting Datasets
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#integer-features">
     Integer Features
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#float-features">
     Float Features
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#string-features">
     String Features
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#writing-tfrecords">
     Writing TFRecords
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-spec">
     Example Spec
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parsing-example">
     Parsing Example
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#tfrecords-dataset">
     TFRecords Dataset
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#numeric-columns">
     Numeric columns
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#indicator-columns">
     Indicator Columns
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#embedding-columns">
     Embedding Columns
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#model-input-layer">
     Model Input Layer
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#model-predictions">
   Model Predictions
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#model-layers">
     Model Layers
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#regression-function">
     Regression Function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#training-mode">
     Training mode
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#evaluation-mode">
     Evaluation Mode
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#prediction-mode">
     Prediction Mode
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#regression-model">
     Regression Model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#model-training">
     Model Training
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#model-evaluation">
     Model Evaluation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#making-predictions">
     Making Predictions
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#result-summary">
   ⛏ Result Summary
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Store Sales Forecasting with TensorFlow</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#preliminary-data-analysis">
   Preliminary Data Analysis
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-dataset">
     The Dataset
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#missing-features">
     Missing Features
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dropping-features">
     Dropping Features
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#filling-in-data">
     Filling in Data
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#merging-data">
     Merging Data
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#categorical-data">
     Categorical Data
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plot-data">
     1. Plot data
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data-processing">
   1. Data Processing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#splitting-datasets">
     1. Splitting Datasets
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#integer-features">
     Integer Features
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#float-features">
     Float Features
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#string-features">
     String Features
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#writing-tfrecords">
     Writing TFRecords
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-spec">
     Example Spec
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parsing-example">
     Parsing Example
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#tfrecords-dataset">
     TFRecords Dataset
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#numeric-columns">
     Numeric columns
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#indicator-columns">
     Indicator Columns
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#embedding-columns">
     Embedding Columns
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#model-input-layer">
     Model Input Layer
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#model-predictions">
   Model Predictions
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#model-layers">
     Model Layers
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#regression-function">
     Regression Function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#training-mode">
     Training mode
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#evaluation-mode">
     Evaluation Mode
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#prediction-mode">
     Prediction Mode
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#regression-model">
     Regression Model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#model-training">
     Model Training
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#model-evaluation">
     Model Evaluation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#making-predictions">
     Making Predictions
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#result-summary">
   ⛏ Result Summary
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="store-sales-forecasting-with-tensorflow">
<h1>Store Sales Forecasting with TensorFlow<a class="headerlink" href="#store-sales-forecasting-with-tensorflow" title="Permalink to this headline">¶</a></h1>
<p>Goal -  The project involves making sales predictions for various stores of a large retail corporation, based on past sales of these stores, using TensorFlow</p>
<p>The dataset comes in three CSV files: weekly_sales.csv, features.csv, and stores.csv</p>
<section id="preliminary-data-analysis">
<h2>Preliminary Data Analysis<a class="headerlink" href="#preliminary-data-analysis" title="Permalink to this headline">¶</a></h2>
<section id="the-dataset">
<h3>The Dataset<a class="headerlink" href="#the-dataset" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">train_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;./storeSalesForecasting/train.csv&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">train_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        Store  Dept        Date  Weekly_Sales  IsHoliday
0           1     1  2010-02-05      24924.50      False
1           1     1  2010-02-12      46039.49       True
2           1     1  2010-02-19      41595.55      False
3           1     1  2010-02-26      19403.54      False
4           1     1  2010-03-05      21827.90      False
...       ...   ...         ...           ...        ...
421565     45    98  2012-09-28        508.37      False
421566     45    98  2012-10-05        628.10      False
421567     45    98  2012-10-12       1061.02      False
421568     45    98  2012-10-19        760.01      False
421569     45    98  2012-10-26       1076.80      False

[421570 rows x 5 columns]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">read_dataframes</span><span class="p">():</span>
    <span class="n">train_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;./storeSalesForecasting/train.csv&#39;</span><span class="p">)</span>
    <span class="n">features_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;./storeSalesForecasting/features.csv&#39;</span><span class="p">)</span>
    <span class="n">stores_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;./storeSalesForecasting/stores.csv&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">train_df</span><span class="p">,</span> <span class="n">features_df</span><span class="p">,</span> <span class="n">stores_df</span><span class="p">)</span>

<span class="p">(</span><span class="n">train_df</span><span class="p">,</span> <span class="n">features_df</span><span class="p">,</span> <span class="n">stores_df</span><span class="p">)</span> <span class="o">=</span> <span class="n">read_dataframes</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">general_features</span> <span class="o">=</span> <span class="n">features_df</span><span class="o">.</span><span class="n">columns</span>

<span class="nb">print</span><span class="p">(</span><span class="n">general_features</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;General Features: </span><span class="si">{}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">general_features</span><span class="o">.</span><span class="n">tolist</span><span class="p">()))</span>

<span class="n">store_features</span> <span class="o">=</span> <span class="n">stores_df</span><span class="o">.</span><span class="n">columns</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Store Features: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">store_features</span><span class="o">.</span><span class="n">tolist</span><span class="p">()))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;Store&#39;, &#39;Date&#39;, &#39;Temperature&#39;, &#39;Fuel_Price&#39;, &#39;MarkDown1&#39;, &#39;MarkDown2&#39;,
       &#39;MarkDown3&#39;, &#39;MarkDown4&#39;, &#39;MarkDown5&#39;, &#39;CPI&#39;, &#39;Unemployment&#39;,
       &#39;IsHoliday&#39;],
      dtype=&#39;object&#39;)
General Features: [&#39;Store&#39;, &#39;Date&#39;, &#39;Temperature&#39;, &#39;Fuel_Price&#39;, &#39;MarkDown1&#39;, &#39;MarkDown2&#39;, &#39;MarkDown3&#39;, &#39;MarkDown4&#39;, &#39;MarkDown5&#39;, &#39;CPI&#39;, &#39;Unemployment&#39;, &#39;IsHoliday&#39;]

Store Features: [&#39;Store&#39;, &#39;Type&#39;, &#39;Size&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">merged_features</span> <span class="o">=</span> <span class="n">features_df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">stores_df</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;Store&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">merged_features</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>      Store        Date  Temperature  Fuel_Price  MarkDown1  MarkDown2  \
0         1  2010-02-05        42.31       2.572        NaN        NaN   
1         1  2010-02-12        38.51       2.548        NaN        NaN   
2         1  2010-02-19        39.93       2.514        NaN        NaN   
3         1  2010-02-26        46.63       2.561        NaN        NaN   
4         1  2010-03-05        46.50       2.625        NaN        NaN   
...     ...         ...          ...         ...        ...        ...   
8185     45  2013-06-28        76.05       3.639    4842.29     975.03   
8186     45  2013-07-05        77.50       3.614    9090.48    2268.58   
8187     45  2013-07-12        79.37       3.614    3789.94    1827.31   
8188     45  2013-07-19        82.84       3.737    2961.49    1047.07   
8189     45  2013-07-26        76.06       3.804     212.02     851.73   

      MarkDown3  MarkDown4  MarkDown5         CPI  Unemployment  IsHoliday  \
0           NaN        NaN        NaN  211.096358         8.106      False   
1           NaN        NaN        NaN  211.242170         8.106       True   
2           NaN        NaN        NaN  211.289143         8.106      False   
3           NaN        NaN        NaN  211.319643         8.106      False   
4           NaN        NaN        NaN  211.350143         8.106      False   
...         ...        ...        ...         ...           ...        ...   
8185       3.00    2449.97    3169.69         NaN           NaN      False   
8186     582.74    5797.47    1514.93         NaN           NaN      False   
8187      85.72     744.84    2150.36         NaN           NaN      False   
8188     204.19     363.00    1059.46         NaN           NaN      False   
8189       2.06      10.88    1864.57         NaN           NaN      False   

     Type    Size  
0       A  151315  
1       A  151315  
2       A  151315  
3       A  151315  
4       A  151315  
...   ...     ...  
8185    B  118221  
8186    B  118221  
8187    B  118221  
8188    B  118221  
8189    B  118221  

[8190 rows x 14 columns]
</pre></div>
</div>
</div>
</div>
</section>
<section id="missing-features">
<h3>Missing Features<a class="headerlink" href="#missing-features" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">na_values</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">merged_features</span><span class="p">)</span> <span class="c1"># Boolean DataFrame</span>
<span class="n">na_features</span> <span class="o">=</span> <span class="n">na_values</span><span class="o">.</span><span class="n">any</span><span class="p">()</span> <span class="c1"># Boolean Series</span>
<span class="nb">print</span><span class="p">(</span><span class="n">na_features</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Store           False
Date            False
Temperature     False
Fuel_Price      False
MarkDown1        True
MarkDown2        True
MarkDown3        True
MarkDown4        True
MarkDown5        True
CPI              True
Unemployment     True
IsHoliday       False
Type            False
Size            False
dtype: bool
</pre></div>
</div>
</div>
</div>
</section>
<section id="dropping-features">
<h3>Dropping Features<a class="headerlink" href="#dropping-features" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total = </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">na_values</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MarkDown1 = </span><span class="si">{</span><span class="nb">sum</span><span class="p">(</span><span class="n">na_values</span><span class="p">[</span><span class="s1">&#39;MarkDown1&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MarkDown2 = </span><span class="si">{</span><span class="nb">sum</span><span class="p">(</span><span class="n">na_values</span><span class="p">[</span><span class="s1">&#39;MarkDown2&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MarkDown3 = </span><span class="si">{</span><span class="nb">sum</span><span class="p">(</span><span class="n">na_values</span><span class="p">[</span><span class="s1">&#39;MarkDown3&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MarkDown4 = </span><span class="si">{</span><span class="nb">sum</span><span class="p">(</span><span class="n">na_values</span><span class="p">[</span><span class="s1">&#39;MarkDown4&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MarkDown5 = </span><span class="si">{</span><span class="nb">sum</span><span class="p">(</span><span class="n">na_values</span><span class="p">[</span><span class="s1">&#39;MarkDown5&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;CPI = </span><span class="si">{</span><span class="nb">sum</span><span class="p">(</span><span class="n">na_values</span><span class="p">[</span><span class="s1">&#39;CPI&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unemployment = </span><span class="si">{</span><span class="nb">sum</span><span class="p">(</span><span class="n">na_values</span><span class="p">[</span><span class="s1">&#39;Unemployment&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total = 8190
MarkDown1 = 4158
MarkDown2 = 5269
MarkDown3 = 4577
MarkDown4 = 4726
MarkDown5 = 4140
CPI = 585
Unemployment = 585
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Drop MarkDown columns, while drop missing CPI and Unemployment missing values</span>
<span class="n">markdowns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;MarkDown1&#39;</span><span class="p">,</span> <span class="s1">&#39;MarkDown2&#39;</span><span class="p">,</span> <span class="s1">&#39;MarkDown3&#39;</span><span class="p">,</span> <span class="s1">&#39;MarkDown4&#39;</span><span class="p">,</span> <span class="s1">&#39;MarkDown5&#39;</span><span class="p">,</span> <span class="p">]</span>
<span class="n">merged_features</span> <span class="o">=</span> <span class="n">merged_features</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">markdowns</span><span class="p">)</span>
<span class="n">merged_features</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;Store&#39;,
 &#39;Date&#39;,
 &#39;Temperature&#39;,
 &#39;Fuel_Price&#39;,
 &#39;CPI&#39;,
 &#39;Unemployment&#39;,
 &#39;IsHoliday&#39;,
 &#39;Type&#39;,
 &#39;Size&#39;]
</pre></div>
</div>
</div>
</div>
</section>
<section id="filling-in-data">
<h3>Filling in Data<a class="headerlink" href="#filling-in-data" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>find missing CPI and Unemployment values</p></li>
<li><p>fill it with previous row values</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">merged_features</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Int64Index: 8190 entries, 0 to 8189
Data columns (total 9 columns):
 #   Column        Non-Null Count  Dtype  
---  ------        --------------  -----  
 0   Store         8190 non-null   int64  
 1   Date          8190 non-null   object 
 2   Temperature   8190 non-null   float64
 3   Fuel_Price    8190 non-null   float64
 4   CPI           7605 non-null   float64
 5   Unemployment  7605 non-null   float64
 6   IsHoliday     8190 non-null   bool   
 7   Type          8190 non-null   object 
 8   Size          8190 non-null   int64  
dtypes: bool(1), float64(4), int64(2), object(2)
memory usage: 583.9+ KB
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># merged_features[[&#39;CPI&#39;, &#39;Unemployment&#39;]]</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">na_cpi_int</span> <span class="o">=</span> <span class="n">na_values</span><span class="p">[</span><span class="s1">&#39;CPI&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">na_indexes_cpi</span> <span class="o">=</span> <span class="n">na_cpi_int</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span><span class="o">.</span><span class="n">nonzero</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">na_une_int</span> <span class="o">=</span> <span class="n">na_values</span><span class="p">[</span><span class="s1">&#39;Unemployment&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">na_indexes_une</span> <span class="o">=</span> <span class="n">na_une_int</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span><span class="o">.</span><span class="n">nonzero</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">na_indexes_cpi</span><span class="p">,</span> <span class="n">na_indexes_une</span><span class="p">))</span> <span class="c1"># Same index for both fields</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">na_indexes</span> <span class="o">=</span> <span class="n">na_indexes_cpi</span>
<span class="n">na_rows</span> <span class="o">=</span> <span class="n">merged_features</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">na_indexes</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">na_rows</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span> <span class="c1"># missing value weeks</span>
<span class="nb">print</span><span class="p">(</span><span class="n">merged_features</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()[</span><span class="o">-</span><span class="mi">13</span><span class="p">:])</span> <span class="c1"># last 13 weeks</span>
<span class="nb">print</span><span class="p">(</span><span class="n">na_rows</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Store&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;2013-05-03&#39; &#39;2013-05-10&#39; &#39;2013-05-17&#39; &#39;2013-05-24&#39; &#39;2013-05-31&#39;
 &#39;2013-06-07&#39; &#39;2013-06-14&#39; &#39;2013-06-21&#39; &#39;2013-06-28&#39; &#39;2013-07-05&#39;
 &#39;2013-07-12&#39; &#39;2013-07-19&#39; &#39;2013-07-26&#39;]
[&#39;2013-05-03&#39; &#39;2013-05-10&#39; &#39;2013-05-17&#39; &#39;2013-05-24&#39; &#39;2013-05-31&#39;
 &#39;2013-06-07&#39; &#39;2013-06-14&#39; &#39;2013-06-21&#39; &#39;2013-06-28&#39; &#39;2013-07-05&#39;
 &#39;2013-07-12&#39; &#39;2013-07-19&#39; &#39;2013-07-26&#39;]
[13]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># na_rows</span>
<span class="c1"># merged_features</span>
<span class="c1"># na_rows.groupby(&#39;Store&#39;).count()[&#39;Date&#39;].unique() # 13</span>
<span class="c1"># merged_features.groupby(&#39;Store&#39;).count()[&#39;Date&#39;].unique() # 182</span>
<span class="c1"># merged_features[&#39;Date&#39;].unique()</span>

<span class="c1"># Fill in the values</span>
<span class="c1"># merged_features</span>
<span class="nb">print</span><span class="p">(</span><span class="n">na_indexes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>  <span class="c1"># first missing value row index</span>
<span class="c1"># print(na_indexes)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="n">first_missing_row</span> <span class="o">=</span> <span class="n">merged_features</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">169</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">first_missing_row</span><span class="p">[[</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span><span class="s1">&#39;CPI&#39;</span><span class="p">,</span><span class="s1">&#39;Unemployment&#39;</span><span class="p">]])</span>
<span class="nb">print</span><span class="p">()</span>

<span class="n">final_val_row</span> <span class="o">=</span> <span class="n">merged_features</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">168</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">final_val_row</span><span class="p">[[</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span><span class="s1">&#39;CPI&#39;</span><span class="p">,</span><span class="s1">&#39;Unemployment&#39;</span><span class="p">]])</span>
<span class="nb">print</span><span class="p">()</span>

<span class="n">cpi_final_val</span> <span class="o">=</span> <span class="n">merged_features</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">168</span><span class="p">,</span> <span class="s1">&#39;CPI&#39;</span><span class="p">]</span>
<span class="n">une_final_val</span> <span class="o">=</span> <span class="n">merged_features</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">168</span><span class="p">,</span> <span class="s1">&#39;Unemployment&#39;</span><span class="p">]</span>
<span class="n">merged_features</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">169</span><span class="p">,</span> <span class="s1">&#39;CPI&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cpi_final_val</span>
<span class="n">merged_features</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">169</span><span class="p">,</span> <span class="s1">&#39;Unemployment&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">une_final_val</span>

<span class="n">new_row</span> <span class="o">=</span> <span class="n">merged_features</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">169</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">new_row</span><span class="p">[[</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span><span class="s1">&#39;CPI&#39;</span><span class="p">,</span><span class="s1">&#39;Unemployment&#39;</span><span class="p">]])</span>
<span class="nb">print</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>169

Date            2013-05-03
CPI                    NaN
Unemployment           NaN
Name: 169, dtype: object

Date            2013-04-26
CPI              225.17016
Unemployment         6.314
Name: 168, dtype: object

Date            2013-05-03
CPI              225.17016
Unemployment         6.314
Name: 169, dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">impute_data</span><span class="p">(</span><span class="n">merged_features</span><span class="p">,</span> <span class="n">na_indexes_cpi</span><span class="p">,</span> <span class="n">na_indexes_une</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">na_indexes_cpi</span><span class="p">:</span>
        <span class="n">merged_features</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;CPI&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">merged_features</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;CPI&#39;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">na_indexes_une</span><span class="p">:</span>
        <span class="n">merged_features</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;Unemployment&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">merged_features</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Unemployment&#39;</span><span class="p">]</span>
        
<span class="n">impute_data</span><span class="p">(</span><span class="n">merged_features</span><span class="p">,</span> <span class="n">na_indexes_cpi</span><span class="p">,</span> <span class="n">na_indexes_une</span><span class="p">)</span>
<span class="n">na_values2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">merged_features</span><span class="p">)</span> <span class="c1"># Boolean DataFrame</span>
<span class="n">na_features2</span> <span class="o">=</span> <span class="n">na_values2</span><span class="o">.</span><span class="n">any</span><span class="p">()</span> <span class="c1"># Boolean Series</span>
<span class="nb">print</span><span class="p">(</span><span class="n">na_features2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Store           False
Date            False
Temperature     False
Fuel_Price      False
CPI             False
Unemployment    False
IsHoliday       False
Type            False
Size            False
dtype: bool
</pre></div>
</div>
</div>
</div>
</section>
<section id="merging-data">
<h3>Merging Data<a class="headerlink" href="#merging-data" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">train_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">merged_features</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;Store&#39;, &#39;Dept&#39;, &#39;Date&#39;, &#39;Weekly_Sales&#39;, &#39;IsHoliday&#39;]
[&#39;Store&#39;, &#39;Date&#39;, &#39;Temperature&#39;, &#39;Fuel_Price&#39;, &#39;CPI&#39;, &#39;Unemployment&#39;, &#39;IsHoliday&#39;, &#39;Type&#39;, &#39;Size&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Common columns - [&#39;Store&#39;, &#39;Date&#39;, &#39;IsHoliday&#39;]</span>
<span class="n">features</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Store&#39;</span><span class="p">,</span> <span class="s1">&#39;Date&#39;</span><span class="p">,</span> <span class="s1">&#39;IsHoliday&#39;</span><span class="p">]</span>
<span class="n">final_dataset</span> <span class="o">=</span> <span class="n">train_df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">merged_features</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="n">features</span><span class="p">)</span>
<span class="n">final_dataset</span>
<span class="c1"># print(train_df[&#39;Store&#39;].unique())</span>
<span class="c1"># print(train_df[&#39;Date&#39;].unique())# Less dates</span>
<span class="c1"># print(train_df[&#39;IsHoliday&#39;].unique())</span>

<span class="c1"># print(merged_features[&#39;Store&#39;].unique())</span>
<span class="c1"># print(merged_features[&#39;Date&#39;].unique()) # More dates</span>
<span class="c1"># print(merged_features[&#39;IsHoliday&#39;].unique())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Store</th>
      <th>Dept</th>
      <th>Date</th>
      <th>Weekly_Sales</th>
      <th>IsHoliday</th>
      <th>Temperature</th>
      <th>Fuel_Price</th>
      <th>CPI</th>
      <th>Unemployment</th>
      <th>Type</th>
      <th>Size</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1</td>
      <td>2010-02-05</td>
      <td>24924.50</td>
      <td>False</td>
      <td>42.31</td>
      <td>2.572</td>
      <td>211.096358</td>
      <td>8.106</td>
      <td>A</td>
      <td>151315</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>2</td>
      <td>2010-02-05</td>
      <td>50605.27</td>
      <td>False</td>
      <td>42.31</td>
      <td>2.572</td>
      <td>211.096358</td>
      <td>8.106</td>
      <td>A</td>
      <td>151315</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>3</td>
      <td>2010-02-05</td>
      <td>13740.12</td>
      <td>False</td>
      <td>42.31</td>
      <td>2.572</td>
      <td>211.096358</td>
      <td>8.106</td>
      <td>A</td>
      <td>151315</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>4</td>
      <td>2010-02-05</td>
      <td>39954.04</td>
      <td>False</td>
      <td>42.31</td>
      <td>2.572</td>
      <td>211.096358</td>
      <td>8.106</td>
      <td>A</td>
      <td>151315</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>5</td>
      <td>2010-02-05</td>
      <td>32229.38</td>
      <td>False</td>
      <td>42.31</td>
      <td>2.572</td>
      <td>211.096358</td>
      <td>8.106</td>
      <td>A</td>
      <td>151315</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>421565</th>
      <td>45</td>
      <td>93</td>
      <td>2012-10-26</td>
      <td>2487.80</td>
      <td>False</td>
      <td>58.85</td>
      <td>3.882</td>
      <td>192.308899</td>
      <td>8.667</td>
      <td>B</td>
      <td>118221</td>
    </tr>
    <tr>
      <th>421566</th>
      <td>45</td>
      <td>94</td>
      <td>2012-10-26</td>
      <td>5203.31</td>
      <td>False</td>
      <td>58.85</td>
      <td>3.882</td>
      <td>192.308899</td>
      <td>8.667</td>
      <td>B</td>
      <td>118221</td>
    </tr>
    <tr>
      <th>421567</th>
      <td>45</td>
      <td>95</td>
      <td>2012-10-26</td>
      <td>56017.47</td>
      <td>False</td>
      <td>58.85</td>
      <td>3.882</td>
      <td>192.308899</td>
      <td>8.667</td>
      <td>B</td>
      <td>118221</td>
    </tr>
    <tr>
      <th>421568</th>
      <td>45</td>
      <td>97</td>
      <td>2012-10-26</td>
      <td>6817.48</td>
      <td>False</td>
      <td>58.85</td>
      <td>3.882</td>
      <td>192.308899</td>
      <td>8.667</td>
      <td>B</td>
      <td>118221</td>
    </tr>
    <tr>
      <th>421569</th>
      <td>45</td>
      <td>98</td>
      <td>2012-10-26</td>
      <td>1076.80</td>
      <td>False</td>
      <td>58.85</td>
      <td>3.882</td>
      <td>192.308899</td>
      <td>8.667</td>
      <td>B</td>
      <td>118221</td>
    </tr>
  </tbody>
</table>
<p>421570 rows × 11 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># &#39;Date&#39; is not used in ML model, so drop it</span>
<span class="n">final_dataset</span> <span class="o">=</span> <span class="n">final_dataset</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="categorical-data">
<h3>Categorical Data<a class="headerlink" href="#categorical-data" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">final_dataset</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Store</th>
      <th>Dept</th>
      <th>Weekly_Sales</th>
      <th>IsHoliday</th>
      <th>Temperature</th>
      <th>Fuel_Price</th>
      <th>CPI</th>
      <th>Unemployment</th>
      <th>Type</th>
      <th>Size</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>421570.000000</td>
      <td>421570.000000</td>
      <td>421570.000000</td>
      <td>421570</td>
      <td>421570.000000</td>
      <td>421570.000000</td>
      <td>421570.000000</td>
      <td>421570.000000</td>
      <td>421570</td>
      <td>421570.000000</td>
    </tr>
    <tr>
      <th>unique</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>top</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>False</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>A</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>freq</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>391909</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>215478</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>22.200546</td>
      <td>44.260317</td>
      <td>15981.258123</td>
      <td>NaN</td>
      <td>60.090059</td>
      <td>3.361027</td>
      <td>171.201947</td>
      <td>7.960289</td>
      <td>NaN</td>
      <td>136727.915739</td>
    </tr>
    <tr>
      <th>std</th>
      <td>12.785297</td>
      <td>30.492054</td>
      <td>22711.183519</td>
      <td>NaN</td>
      <td>18.447931</td>
      <td>0.458515</td>
      <td>39.159276</td>
      <td>1.863296</td>
      <td>NaN</td>
      <td>60980.583328</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>-4988.940000</td>
      <td>NaN</td>
      <td>-2.060000</td>
      <td>2.472000</td>
      <td>126.064000</td>
      <td>3.879000</td>
      <td>NaN</td>
      <td>34875.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>11.000000</td>
      <td>18.000000</td>
      <td>2079.650000</td>
      <td>NaN</td>
      <td>46.680000</td>
      <td>2.933000</td>
      <td>132.022667</td>
      <td>6.891000</td>
      <td>NaN</td>
      <td>93638.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>22.000000</td>
      <td>37.000000</td>
      <td>7612.030000</td>
      <td>NaN</td>
      <td>62.090000</td>
      <td>3.452000</td>
      <td>182.318780</td>
      <td>7.866000</td>
      <td>NaN</td>
      <td>140167.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>33.000000</td>
      <td>74.000000</td>
      <td>20205.852500</td>
      <td>NaN</td>
      <td>74.280000</td>
      <td>3.738000</td>
      <td>212.416993</td>
      <td>8.572000</td>
      <td>NaN</td>
      <td>202505.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>45.000000</td>
      <td>99.000000</td>
      <td>693099.360000</td>
      <td>NaN</td>
      <td>100.140000</td>
      <td>4.468000</td>
      <td>227.232807</td>
      <td>14.313000</td>
      <td>NaN</td>
      <td>219622.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">final_dataset</span><span class="p">[</span><span class="s1">&#39;Type&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">final_dataset</span><span class="p">[</span><span class="s1">&#39;Dept&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;A&#39; &#39;B&#39; &#39;C&#39;]
[ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 16 17 18 19 20 21 22 23 24 25
 26 27 28 29 30 31 32 33 34 35 36 37 38 40 41 42 44 45 46 47 48 49 51 52
 54 55 56 58 59 60 67 71 72 74 79 80 81 82 83 85 87 90 91 92 93 94 95 97
 98 78 96 99 77 39 50 43 65]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Cast IsHoliday to type int - features must be integer, float, or string</span>
<span class="n">final_dataset</span> <span class="o">=</span> <span class="n">final_dataset</span><span class="o">.</span><span class="n">astype</span><span class="p">({</span><span class="s2">&quot;IsHoliday&quot;</span><span class="p">:</span> <span class="nb">int</span><span class="p">})</span>
<span class="n">final_dataset</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Int64Index: 421570 entries, 0 to 421569
Data columns (total 10 columns):
 #   Column        Non-Null Count   Dtype  
---  ------        --------------   -----  
 0   Store         421570 non-null  int64  
 1   Dept          421570 non-null  int64  
 2   Weekly_Sales  421570 non-null  float64
 3   IsHoliday     421570 non-null  int64  
 4   Temperature   421570 non-null  float64
 5   Fuel_Price    421570 non-null  float64
 6   CPI           421570 non-null  float64
 7   Unemployment  421570 non-null  float64
 8   Type          421570 non-null  object 
 9   Size          421570 non-null  int64  
dtypes: float64(5), int64(4), object(1)
memory usage: 35.4+ MB
</pre></div>
</div>
</div>
</div>
</section>
<section id="plot-data">
<h3>1. Plot data<a class="headerlink" href="#plot-data" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">plot_df</span> <span class="o">=</span> <span class="n">final_dataset</span><span class="p">[[</span><span class="s1">&#39;Weekly_Sales&#39;</span><span class="p">,</span> <span class="s1">&#39;Temperature&#39;</span><span class="p">]]</span>
<span class="n">rounded_temp</span> <span class="o">=</span> <span class="n">plot_df</span><span class="p">[</span><span class="s1">&#39;Temperature&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">round</span><span class="p">()</span>
<span class="n">plot_df</span> <span class="o">=</span> <span class="n">plot_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">rounded_temp</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">plot_df</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Temperature&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Weekly_Sales&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Temperature vs. Weekly Sales&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Temperature (Fahrenheit)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Avg Weekly Sales (Dollars)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Store_Sales_Forecasting_With_Tensorflow_27_0.png" src="../_images/Store_Sales_Forecasting_With_Tensorflow_27_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_df</span> <span class="o">=</span> <span class="n">final_dataset</span><span class="p">[[</span><span class="s1">&#39;Weekly_Sales&#39;</span><span class="p">,</span> <span class="s1">&#39;Fuel_Price&#39;</span><span class="p">]]</span>
<span class="n">rounded_temp</span> <span class="o">=</span> <span class="n">plot_df</span><span class="p">[</span><span class="s1">&#39;Fuel_Price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plot_df</span> <span class="o">=</span> <span class="n">plot_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">rounded_temp</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">plot_df</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Fuel_Price&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Weekly_Sales&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Fuel Price vs. Weekly Sales&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Fuel Price ($/gallon, Nearest Hundredth)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Avg Weekly Sales (Dollars)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="c1"># plot_df[&#39;Fuel_Price&#39;].round(1).unique()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Store_Sales_Forecasting_With_Tensorflow_28_0.png" src="../_images/Store_Sales_Forecasting_With_Tensorflow_28_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_df</span> <span class="o">=</span> <span class="n">final_dataset</span><span class="p">[[</span><span class="s1">&#39;Weekly_Sales&#39;</span><span class="p">,</span> <span class="s1">&#39;Type&#39;</span><span class="p">]]</span>
<span class="n">plot_df</span> <span class="o">=</span> <span class="n">plot_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Type&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">plot_df</span><span class="p">)</span>
<span class="n">plot_df</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">bar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Store Type vs. Weekly Sales&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Type&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Avg Weekly Sales (Dollars)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>      Weekly_Sales
Type              
A     20099.568043
B     12237.075977
C      9519.532538
</pre></div>
</div>
<img alt="../_images/Store_Sales_Forecasting_With_Tensorflow_29_1.png" src="../_images/Store_Sales_Forecasting_With_Tensorflow_29_1.png" />
</div>
</div>
</section>
</section>
<section id="data-processing">
<h2>1. Data Processing<a class="headerlink" href="#data-processing" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>create efficient input pipeline</p></li>
</ul>
<section id="splitting-datasets">
<h3>1. Splitting Datasets<a class="headerlink" href="#splitting-datasets" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>training and evaluation</p></li>
<li><p>set proportions</p></li>
<li><p>removing systematic trends</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># from random import randrange</span>
<span class="c1"># print(randrange(10))</span>


<span class="c1"># X1 = np.random.randint(low=0, high=10, size=(15,))</span>
<span class="c1"># print(X1)</span>

<span class="kn">import</span> <span class="nn">random</span>
<span class="c1"># random.sample(range(100), 10)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">split_train_eval</span><span class="p">(</span><span class="n">final_dataset</span><span class="p">):</span>
    <span class="n">len_dataset</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">final_dataset</span><span class="p">)</span>
    <span class="n">len_train_dataset</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="mf">0.9</span><span class="o">*</span><span class="n">len_dataset</span><span class="p">)</span>
    <span class="n">len_evaluate_dataset</span> <span class="o">=</span> <span class="n">len_dataset</span> <span class="o">-</span> <span class="n">len_train_dataset</span>
    <span class="n">rnd_train_samples</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">len_dataset</span><span class="p">),</span> <span class="n">len_train_dataset</span><span class="p">)</span>
    <span class="n">rnd_evaluate_samples</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">len_dataset</span><span class="p">))</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">rnd_train_samples</span><span class="p">))</span>
    <span class="n">train_dataset</span> <span class="o">=</span> <span class="n">final_dataset</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">rnd_train_samples</span><span class="p">]</span>
    <span class="n">evaluate_dataset</span> <span class="o">=</span> <span class="n">final_dataset</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">rnd_evaluate_samples</span><span class="p">]</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">train_dataset</span><span class="p">,</span> <span class="n">evaluate_dataset</span><span class="p">)</span>

<span class="n">train_set</span><span class="p">,</span> <span class="n">eval_set</span> <span class="o">=</span> <span class="n">split_train_eval</span><span class="p">(</span><span class="n">final_dataset</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train_set</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Store</th>
      <th>Dept</th>
      <th>Weekly_Sales</th>
      <th>IsHoliday</th>
      <th>Temperature</th>
      <th>Fuel_Price</th>
      <th>CPI</th>
      <th>Unemployment</th>
      <th>Type</th>
      <th>Size</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>184871</th>
      <td>19</td>
      <td>13</td>
      <td>32400.91</td>
      <td>0</td>
      <td>34.83</td>
      <td>3.983</td>
      <td>137.423897</td>
      <td>7.943</td>
      <td>A</td>
      <td>203819</td>
    </tr>
    <tr>
      <th>401410</th>
      <td>43</td>
      <td>87</td>
      <td>124.90</td>
      <td>0</td>
      <td>88.49</td>
      <td>3.637</td>
      <td>206.856024</td>
      <td>10.581</td>
      <td>C</td>
      <td>41062</td>
    </tr>
    <tr>
      <th>70452</th>
      <td>8</td>
      <td>28</td>
      <td>257.98</td>
      <td>0</td>
      <td>78.29</td>
      <td>2.608</td>
      <td>214.602966</td>
      <td>6.315</td>
      <td>A</td>
      <td>155078</td>
    </tr>
    <tr>
      <th>355755</th>
      <td>38</td>
      <td>96</td>
      <td>9860.08</td>
      <td>0</td>
      <td>57.79</td>
      <td>3.130</td>
      <td>126.546161</td>
      <td>14.313</td>
      <td>C</td>
      <td>39690</td>
    </tr>
    <tr>
      <th>265168</th>
      <td>27</td>
      <td>50</td>
      <td>2833.00</td>
      <td>0</td>
      <td>53.68</td>
      <td>4.124</td>
      <td>142.017793</td>
      <td>8.253</td>
      <td>A</td>
      <td>204184</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>376417</th>
      <td>40</td>
      <td>37</td>
      <td>1548.02</td>
      <td>0</td>
      <td>68.10</td>
      <td>3.903</td>
      <td>136.054032</td>
      <td>4.584</td>
      <td>A</td>
      <td>155083</td>
    </tr>
    <tr>
      <th>383046</th>
      <td>41</td>
      <td>71</td>
      <td>6182.04</td>
      <td>0</td>
      <td>70.59</td>
      <td>2.731</td>
      <td>190.328492</td>
      <td>7.335</td>
      <td>A</td>
      <td>196321</td>
    </tr>
    <tr>
      <th>400605</th>
      <td>43</td>
      <td>83</td>
      <td>5186.06</td>
      <td>0</td>
      <td>59.15</td>
      <td>3.045</td>
      <td>205.168321</td>
      <td>10.398</td>
      <td>C</td>
      <td>41062</td>
    </tr>
    <tr>
      <th>225950</th>
      <td>23</td>
      <td>81</td>
      <td>8696.98</td>
      <td>0</td>
      <td>69.31</td>
      <td>3.701</td>
      <td>138.203387</td>
      <td>4.156</td>
      <td>B</td>
      <td>114533</td>
    </tr>
    <tr>
      <th>327214</th>
      <td>34</td>
      <td>90</td>
      <td>49171.02</td>
      <td>0</td>
      <td>41.04</td>
      <td>3.286</td>
      <td>129.816710</td>
      <td>10.148</td>
      <td>A</td>
      <td>158114</td>
    </tr>
  </tbody>
</table>
<p>379413 rows × 10 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eval_set</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Store</th>
      <th>Dept</th>
      <th>Weekly_Sales</th>
      <th>IsHoliday</th>
      <th>Temperature</th>
      <th>Fuel_Price</th>
      <th>CPI</th>
      <th>Unemployment</th>
      <th>Type</th>
      <th>Size</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>131072</th>
      <td>14</td>
      <td>40</td>
      <td>63699.29</td>
      <td>1</td>
      <td>46.15</td>
      <td>3.039</td>
      <td>182.783277</td>
      <td>8.724</td>
      <td>A</td>
      <td>200898</td>
    </tr>
    <tr>
      <th>262145</th>
      <td>27</td>
      <td>42</td>
      <td>9895.00</td>
      <td>0</td>
      <td>77.83</td>
      <td>3.915</td>
      <td>139.700633</td>
      <td>7.850</td>
      <td>A</td>
      <td>204184</td>
    </tr>
    <tr>
      <th>393217</th>
      <td>42</td>
      <td>16</td>
      <td>781.02</td>
      <td>0</td>
      <td>57.06</td>
      <td>3.236</td>
      <td>126.983581</td>
      <td>9.003</td>
      <td>C</td>
      <td>39690</td>
    </tr>
    <tr>
      <th>393222</th>
      <td>42</td>
      <td>28</td>
      <td>64.00</td>
      <td>0</td>
      <td>57.06</td>
      <td>3.236</td>
      <td>126.983581</td>
      <td>9.003</td>
      <td>C</td>
      <td>39690</td>
    </tr>
    <tr>
      <th>393225</th>
      <td>42</td>
      <td>38</td>
      <td>35589.81</td>
      <td>0</td>
      <td>57.06</td>
      <td>3.236</td>
      <td>126.983581</td>
      <td>9.003</td>
      <td>C</td>
      <td>39690</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>131058</th>
      <td>14</td>
      <td>24</td>
      <td>17875.84</td>
      <td>1</td>
      <td>46.15</td>
      <td>3.039</td>
      <td>182.783277</td>
      <td>8.724</td>
      <td>A</td>
      <td>200898</td>
    </tr>
    <tr>
      <th>262131</th>
      <td>27</td>
      <td>27</td>
      <td>1405.90</td>
      <td>0</td>
      <td>77.83</td>
      <td>3.915</td>
      <td>139.700633</td>
      <td>7.850</td>
      <td>A</td>
      <td>204184</td>
    </tr>
    <tr>
      <th>131060</th>
      <td>14</td>
      <td>26</td>
      <td>23143.55</td>
      <td>1</td>
      <td>46.15</td>
      <td>3.039</td>
      <td>182.783277</td>
      <td>8.724</td>
      <td>A</td>
      <td>200898</td>
    </tr>
    <tr>
      <th>262138</th>
      <td>27</td>
      <td>34</td>
      <td>24049.90</td>
      <td>0</td>
      <td>77.83</td>
      <td>3.915</td>
      <td>139.700633</td>
      <td>7.850</td>
      <td>A</td>
      <td>204184</td>
    </tr>
    <tr>
      <th>262139</th>
      <td>27</td>
      <td>35</td>
      <td>3932.80</td>
      <td>0</td>
      <td>77.83</td>
      <td>3.915</td>
      <td>139.700633</td>
      <td>7.850</td>
      <td>A</td>
      <td>204184</td>
    </tr>
  </tbody>
</table>
<p>42157 rows × 10 columns</p>
</div></div></div>
</div>
</section>
<section id="integer-features">
<h3>Integer Features<a class="headerlink" href="#integer-features" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Add the integer features of a DataFrame’s row to a feature dictionary</span>

<span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>

<span class="k">def</span> <span class="nf">add_int_features</span><span class="p">(</span><span class="n">dataset_row</span><span class="p">,</span> <span class="n">feature_dict</span><span class="p">):</span>
    <span class="n">int_vals</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Store&#39;</span><span class="p">,</span> <span class="s1">&#39;Dept&#39;</span><span class="p">,</span> <span class="s1">&#39;IsHoliday&#39;</span><span class="p">,</span> <span class="s1">&#39;Size&#39;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">feature_name</span> <span class="ow">in</span> <span class="n">int_vals</span><span class="p">:</span>
        <span class="n">list_val</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">Int64List</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="p">[</span><span class="n">dataset_row</span><span class="p">[</span><span class="n">feature_name</span><span class="p">]])</span>
        <span class="n">feature_dict</span><span class="p">[</span><span class="n">feature_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">Feature</span><span class="p">(</span><span class="n">int64_list</span> <span class="o">=</span> <span class="n">list_val</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="nn">Input In [26],</span> in <span class="ni">&lt;cell line: 3&gt;</span><span class="nt">()</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="c1"># Add the integer features of a DataFrame’s row to a feature dictionary</span>
<span class="ne">----&gt; </span><span class="mi">3</span> <span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="k">def</span> <span class="nf">add_int_features</span><span class="p">(</span><span class="n">dataset_row</span><span class="p">,</span> <span class="n">feature_dict</span><span class="p">):</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span>     <span class="n">int_vals</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Store&#39;</span><span class="p">,</span> <span class="s1">&#39;Dept&#39;</span><span class="p">,</span> <span class="s1">&#39;IsHoliday&#39;</span><span class="p">,</span> <span class="s1">&#39;Size&#39;</span><span class="p">]</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;tensorflow&#39;
</pre></div>
</div>
</div>
</div>
</section>
<section id="float-features">
<h3>Float Features<a class="headerlink" href="#float-features" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Add the float Feature objects to the feature dictionary</span>
<span class="k">def</span> <span class="nf">add_float_features</span><span class="p">(</span><span class="n">dataset_row</span><span class="p">,</span> <span class="n">feature_dict</span><span class="p">,</span> <span class="n">has_labels</span><span class="p">):</span>
    <span class="c1"># We only use the &#39;Weekly_Sales&#39; feature if has_labels is True. </span>
    <span class="c1"># This is because the &#39;Weekly_Sales&#39; feature represents the label used </span>
    <span class="c1"># in training/evaluating the machine learning model, which is not present when making predictions.</span>

    <span class="n">float_vals</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Temperature&#39;</span><span class="p">,</span> <span class="s1">&#39;Fuel_Price&#39;</span><span class="p">,</span> <span class="s1">&#39;CPI&#39;</span><span class="p">,</span> <span class="s1">&#39;Unemployment&#39;</span><span class="p">,</span> <span class="p">]</span>
    <span class="k">if</span> <span class="n">has_labels</span><span class="p">:</span>
        <span class="n">float_vals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Weekly_Sales&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">feature_name</span> <span class="ow">in</span> <span class="n">float_vals</span><span class="p">:</span>
        <span class="n">list_val</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">FloatList</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="p">[</span><span class="n">dataset_row</span><span class="p">[</span><span class="n">feature_name</span><span class="p">]])</span>
        <span class="n">feature_dict</span><span class="p">[</span><span class="n">feature_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">Feature</span><span class="p">(</span><span class="n">float_list</span> <span class="o">=</span> <span class="n">list_val</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="string-features">
<h3>String Features<a class="headerlink" href="#string-features" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="s1">&#39;hello world&#39;</span>
<span class="n">byte_s</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>  <span class="c1"># byte string</span>
<span class="n">bytes_list</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">BytesList</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="p">[</span><span class="n">byte_s</span><span class="p">])</span>
<span class="n">feature</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">Feature</span><span class="p">(</span><span class="n">bytes_list</span><span class="o">=</span><span class="n">bytes_list</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">feature</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>bytes_list {
  value: &quot;hello world&quot;
}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create an Example object from a pandas DataFrame row</span>
<span class="k">def</span> <span class="nf">create_example</span><span class="p">(</span><span class="n">dataset_row</span><span class="p">,</span> <span class="n">has_labels</span><span class="p">):</span>
    <span class="n">feature_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">add_int_features</span><span class="p">(</span><span class="n">dataset_row</span><span class="p">,</span> <span class="n">feature_dict</span><span class="p">)</span>
    <span class="n">add_float_features</span><span class="p">(</span><span class="n">dataset_row</span><span class="p">,</span> <span class="n">feature_dict</span><span class="p">,</span> <span class="n">has_labels</span><span class="p">)</span>
    <span class="c1"># CODE HERE</span>
    <span class="n">byte_type</span> <span class="o">=</span> <span class="n">dataset_row</span><span class="p">[</span><span class="s1">&#39;Type&#39;</span><span class="p">]</span>
    <span class="n">list_val</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">BytesList</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="p">[</span><span class="n">byte_type</span><span class="o">.</span><span class="n">encode</span><span class="p">()])</span>
    <span class="n">feature_dict</span><span class="p">[</span><span class="s1">&#39;Type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">Feature</span><span class="p">(</span><span class="n">bytes_list</span> <span class="o">=</span> <span class="n">list_val</span><span class="p">)</span>
    <span class="n">features_obj</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">Features</span><span class="p">(</span><span class="n">feature</span> <span class="o">=</span> <span class="n">feature_dict</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">tf</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">Example</span><span class="p">(</span><span class="n">features</span> <span class="o">=</span> <span class="n">features_obj</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="writing-tfrecords">
<h3>Writing TFRecords<a class="headerlink" href="#writing-tfrecords" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Write serialized Example objects(the training and evaluation set data) to a TFRecords file</span>

<span class="k">def</span> <span class="nf">write_tfrecords</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">tfrecords_file</span><span class="p">,</span> <span class="n">has_labels</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
    <span class="n">writer</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">TFRecordWriter</span><span class="p">(</span><span class="n">tfrecords_file</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">)):</span>
        <span class="n">example</span> <span class="o">=</span> <span class="n">create_example</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">has_labels</span><span class="p">)</span>
        <span class="n">writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">example</span><span class="o">.</span><span class="n">SerializeToString</span><span class="p">())</span>
    <span class="n">writer</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>```{code-cell}
---
tags: [raises-exception]
---

# train_set is the training DataFrame
write_tfrecords(train_set, &#39;train.tfrecords&#39;)

# eval_set is the evaluation DataFrame
write_tfrecords(eval_set, &#39;eval.tfrecords&#39;)

```
</pre></div>
</div>
</div>
</div>
</section>
<section id="example-spec">
<h3>Example Spec<a class="headerlink" href="#example-spec" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>the data is stored as serialized Example objects in TFRecords file</p></li>
<li><p>create an Example spec which parses the serialized examples in the input pipeline</p></li>
<li><p>the example spec gives specifications on each of the dataset’s features, specifically the shape and type of the feature’s values.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">example_spec</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">example_spec</span><span class="p">[</span><span class="s1">&#39;Store&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">FixedLenFeature</span><span class="p">((),</span> <span class="n">tf</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>
<span class="n">example_spec</span><span class="p">[</span><span class="s1">&#39;CPI&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">FixedLenFeature</span><span class="p">((),</span> <span class="n">tf</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">example_spec</span><span class="p">[</span><span class="s1">&#39;Type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">FixedLenFeature</span><span class="p">((),</span> <span class="n">tf</span><span class="o">.</span><span class="n">string</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create the spec used when parsing the Example object</span>
<span class="k">def</span> <span class="nf">create_example_spec</span><span class="p">(</span><span class="n">has_labels</span><span class="p">):</span>
    <span class="n">example_spec</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">int_vals</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Store&#39;</span><span class="p">,</span> <span class="s1">&#39;Dept&#39;</span><span class="p">,</span> <span class="s1">&#39;IsHoliday&#39;</span><span class="p">,</span> <span class="s1">&#39;Size&#39;</span><span class="p">]</span>
    <span class="n">float_vals</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Temperature&#39;</span><span class="p">,</span> <span class="s1">&#39;Fuel_Price&#39;</span><span class="p">,</span> <span class="s1">&#39;CPI&#39;</span><span class="p">,</span> <span class="s1">&#39;Unemployment&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">has_labels</span><span class="p">:</span>
        <span class="n">float_vals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Weekly_Sales&#39;</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">feature_name</span> <span class="ow">in</span> <span class="n">int_vals</span><span class="p">:</span>
        <span class="n">example_spec</span><span class="p">[</span><span class="n">feature_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">FixedLenFeature</span><span class="p">((),</span> <span class="n">tf</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">feature_name</span> <span class="ow">in</span> <span class="n">float_vals</span><span class="p">:</span>
        <span class="n">example_spec</span><span class="p">[</span><span class="n">feature_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">FixedLenFeature</span><span class="p">((),</span> <span class="n">tf</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
    <span class="n">example_spec</span><span class="p">[</span><span class="s1">&#39;Type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">FixedLenFeature</span><span class="p">((),</span> <span class="n">tf</span><span class="o">.</span><span class="n">string</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">example_spec</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="parsing-example">
<h3>Parsing Example<a class="headerlink" href="#parsing-example" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>parse feature data from serialized Example objects</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">example_spec</span> <span class="o">=</span> <span class="n">create_example_spec</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Parsing feature data from a serialized Example (ser_ex) using its corresponding Example spec (example_spec).</span>
<span class="c1"># parsed_example = tf.io.parse_single_example(ser_ex, example_spec)</span>
<span class="c1"># print(parsed_example)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Helper function to convert serialized Example objects into features</span>
<span class="k">def</span> <span class="nf">parse_features</span><span class="p">(</span><span class="n">ser_ex</span><span class="p">,</span> <span class="n">example_spec</span><span class="p">,</span> <span class="n">has_labels</span><span class="p">):</span>
    <span class="c1"># CODE HERE</span>
    <span class="n">parsed_features</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">parse_single_example</span><span class="p">(</span><span class="n">ser_ex</span><span class="p">,</span> <span class="n">example_spec</span><span class="p">)</span>
    <span class="c1"># The &#39;Weekly_Sales&#39; feature is not actually used as an input for the machine learning model. </span>
    <span class="c1"># Instead, it is used as a label during training and evaluation.</span>
    <span class="n">features</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">parsed_features</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">parsed_features</span> <span class="k">if</span> <span class="n">k</span><span class="o">!=</span><span class="s1">&#39;Weekly_Sales&#39;</span><span class="p">}</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">has_labels</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">features</span>
    <span class="n">label</span> <span class="o">=</span> <span class="n">parsed_features</span><span class="p">[</span><span class="s1">&#39;Weekly_Sales&#39;</span><span class="p">]</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span>
    
</pre></div>
</div>
</div>
</div>
</section>
<section id="tfrecords-dataset">
<h3>TFRecords Dataset<a class="headerlink" href="#tfrecords-dataset" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a TFRecords dataset for the input pipeline</span>
<span class="c1"># Parsing feature data from a serialized Example (ser_ex) using its corresponding Example spec (example_spec)</span>

<span class="n">train_file</span> <span class="o">=</span> <span class="s1">&#39;train.tfrecords&#39;</span>
<span class="n">eval_file</span> <span class="o">=</span> <span class="s1">&#39;eval.tfrecords&#39;</span>
<span class="n">train_dataset</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">TFRecordDataset</span><span class="p">(</span><span class="n">train_file</span><span class="p">)</span>
<span class="n">eval_dataset</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">TFRecordDataset</span><span class="p">(</span><span class="n">eval_file</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-08-19 10:10:05.534015: I tensorflow/core/platform/cpu_feature_guard.cc:151] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Using the functions from above to modify the TFRecords datasets.</span>

<span class="n">example_spec</span> <span class="o">=</span> <span class="n">create_example_spec</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">parse_fn</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">ser_ex</span><span class="p">:</span> <span class="n">parse_features</span><span class="p">(</span><span class="n">ser_ex</span><span class="p">,</span> <span class="n">example_spec</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">train_dataset</span> <span class="o">=</span> <span class="n">train_dataset</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">parse_fn</span><span class="p">)</span>
<span class="n">eval_dataset</span> <span class="o">=</span> <span class="n">eval_dataset</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">parse_fn</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">eval_dataset</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;MapDataset element_spec=({&#39;CPI&#39;: TensorSpec(shape=(), dtype=tf.float32, name=None), &#39;Dept&#39;: TensorSpec(shape=(), dtype=tf.int64, name=None), &#39;Fuel_Price&#39;: TensorSpec(shape=(), dtype=tf.float32, name=None), &#39;IsHoliday&#39;: TensorSpec(shape=(), dtype=tf.int64, name=None), &#39;Size&#39;: TensorSpec(shape=(), dtype=tf.int64, name=None), &#39;Store&#39;: TensorSpec(shape=(), dtype=tf.int64, name=None), &#39;Temperature&#39;: TensorSpec(shape=(), dtype=tf.float32, name=None), &#39;Type&#39;: TensorSpec(shape=(), dtype=tf.string, name=None), &#39;Unemployment&#39;: TensorSpec(shape=(), dtype=tf.float32, name=None)}, TensorSpec(shape=(), dtype=tf.float32, name=None))&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">example_spec</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;Store&#39;: FixedLenFeature(shape=(), dtype=tf.int64, default_value=None),
 &#39;Dept&#39;: FixedLenFeature(shape=(), dtype=tf.int64, default_value=None),
 &#39;IsHoliday&#39;: FixedLenFeature(shape=(), dtype=tf.int64, default_value=None),
 &#39;Size&#39;: FixedLenFeature(shape=(), dtype=tf.int64, default_value=None),
 &#39;Temperature&#39;: FixedLenFeature(shape=(), dtype=tf.float32, default_value=None),
 &#39;Fuel_Price&#39;: FixedLenFeature(shape=(), dtype=tf.float32, default_value=None),
 &#39;CPI&#39;: FixedLenFeature(shape=(), dtype=tf.float32, default_value=None),
 &#39;Unemployment&#39;: FixedLenFeature(shape=(), dtype=tf.float32, default_value=None),
 &#39;Weekly_Sales&#39;: FixedLenFeature(shape=(), dtype=tf.float32, default_value=None),
 &#39;Type&#39;: FixedLenFeature(shape=(), dtype=tf.string, default_value=None)}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Configure the dataset - Shuffling datasets is always a good idea for training and evaluation, </span>
<span class="c1"># since it randomizes the order in which the data is passed into the machine learning model. </span>

<span class="n">train_dataset</span> <span class="o">=</span> <span class="n">train_dataset</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="mi">421570</span><span class="p">)</span>
<span class="n">eval_dataset</span> <span class="o">=</span> <span class="n">eval_dataset</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="mi">421570</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">train_dataset</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>tensorflow.python.data.ops.dataset_ops.ShuffleDataset
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Repeating the datasets indefinitely. The training will run until we manually kill the process.</span>

<span class="c1"># We also want to run training indefinitely, until we decide to kill the model </span>
<span class="c1"># running process manually (i.e. with CTRL+C or CMD+C). Evaluation is done with a </span>
<span class="c1"># single run-through of the dataset.</span>

<span class="n">train_dataset</span> <span class="o">=</span> <span class="n">train_dataset</span><span class="o">.</span><span class="n">repeat</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">train_dataset</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;RepeatDataset element_spec=({&#39;CPI&#39;: TensorSpec(shape=(), dtype=tf.float32, name=None), &#39;Dept&#39;: TensorSpec(shape=(), dtype=tf.int64, name=None), &#39;Fuel_Price&#39;: TensorSpec(shape=(), dtype=tf.float32, name=None), &#39;IsHoliday&#39;: TensorSpec(shape=(), dtype=tf.int64, name=None), &#39;Size&#39;: TensorSpec(shape=(), dtype=tf.int64, name=None), &#39;Store&#39;: TensorSpec(shape=(), dtype=tf.int64, name=None), &#39;Temperature&#39;: TensorSpec(shape=(), dtype=tf.float32, name=None), &#39;Type&#39;: TensorSpec(shape=(), dtype=tf.string, name=None), &#39;Unemployment&#39;: TensorSpec(shape=(), dtype=tf.float32, name=None)}, TensorSpec(shape=(), dtype=tf.float32, name=None))&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># set the dataset batch sizes, so that each training/evaluation step contains multiple data observations</span>

<span class="n">train_dataset</span> <span class="o">=</span> <span class="n">train_dataset</span><span class="o">.</span><span class="n">batch</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="n">eval_dataset</span> <span class="o">=</span> <span class="n">eval_dataset</span><span class="o">.</span><span class="n">batch</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="numeric-columns">
<h3>Numeric columns<a class="headerlink" href="#numeric-columns" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">add_numeric_columns</span><span class="p">(</span><span class="n">feature_columns</span><span class="p">):</span>
    <span class="n">numeric_features</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Size&#39;</span><span class="p">,</span> <span class="s1">&#39;Temperature&#39;</span><span class="p">,</span> <span class="s1">&#39;Fuel_Price&#39;</span><span class="p">,</span> <span class="s1">&#39;CPI&#39;</span><span class="p">,</span> <span class="s1">&#39;Unemployment&#39;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">feature_name</span> <span class="ow">in</span> <span class="n">numeric_features</span><span class="p">:</span>
        <span class="n">feature_col</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">feature_column</span><span class="o">.</span><span class="n">numeric_column</span><span class="p">(</span><span class="n">feature_name</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">())</span>
        <span class="n">feature_columns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">feature_col</span><span class="p">)</span>

<span class="c1"># Add the numeric feature columns to the list of dataset feature columns</span>
<span class="n">dataset_feature_columns</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">add_numeric_columns</span><span class="p">(</span><span class="n">dataset_feature_columns</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dataset_feature_columns</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[NumericColumn(key=&#39;Size&#39;, shape=(), default_value=None, dtype=tf.float32, normalizer_fn=None), NumericColumn(key=&#39;Temperature&#39;, shape=(), default_value=None, dtype=tf.float32, normalizer_fn=None), NumericColumn(key=&#39;Fuel_Price&#39;, shape=(), default_value=None, dtype=tf.float32, normalizer_fn=None), NumericColumn(key=&#39;CPI&#39;, shape=(), default_value=None, dtype=tf.float32, normalizer_fn=None), NumericColumn(key=&#39;Unemployment&#39;, shape=(), default_value=None, dtype=tf.float32, normalizer_fn=None)]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">pprint</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">dataset_feature_columns</span><span class="p">)</span>
<span class="c1"># help(tf.feature_column.numeric_column)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[NumericColumn(key=&#39;Size&#39;, shape=(), default_value=None, dtype=tf.float32, normalizer_fn=None),
 NumericColumn(key=&#39;Temperature&#39;, shape=(), default_value=None, dtype=tf.float32, normalizer_fn=None),
 NumericColumn(key=&#39;Fuel_Price&#39;, shape=(), default_value=None, dtype=tf.float32, normalizer_fn=None),
 NumericColumn(key=&#39;CPI&#39;, shape=(), default_value=None, dtype=tf.float32, normalizer_fn=None),
 NumericColumn(key=&#39;Unemployment&#39;, shape=(), default_value=None, dtype=tf.float32, normalizer_fn=None)]
</pre></div>
</div>
</div>
</div>
</section>
<section id="indicator-columns">
<h3>Indicator Columns<a class="headerlink" href="#indicator-columns" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Process the indicator feature columns used for the machine learning model’s input layer</p>
<ul>
<li><p>One-hot indicators</p>
<ul>
<li><p>‘IsHoliday’ (0 and 1)</p></li>
<li><p>‘Type’ (A, B, C)</p></li>
</ul>
</li>
<li><p>Categorical column base</p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Categorical columns for the &#39;IsHoliday&#39; and &#39;Type&#39; features.</span>

<span class="n">type_col</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">feature_column</span><span class="o">.</span><span class="n">categorical_column_with_vocabulary_list</span><span class="p">(</span>
    <span class="s1">&#39;Type&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">string</span><span class="p">)</span>
<span class="n">holiday_col</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">feature_column</span><span class="o">.</span><span class="n">categorical_column_with_vocabulary_list</span><span class="p">(</span>
    <span class="s1">&#39;IsHoliday&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Converting categorical columns to indicator feature columns.</span>

<span class="n">type_feature_col</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">feature_column</span><span class="o">.</span><span class="n">indicator_column</span><span class="p">(</span><span class="n">type_col</span><span class="p">)</span>
<span class="n">holiday_feature_col</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">feature_column</span><span class="o">.</span><span class="n">indicator_column</span><span class="p">(</span><span class="n">holiday_col</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Add the indicator feature columns to the list of feature columns</span>
<span class="k">def</span> <span class="nf">add_indicator_columns</span><span class="p">(</span><span class="n">final_dataset</span><span class="p">,</span> <span class="n">feature_columns</span><span class="p">):</span>
    <span class="n">indicator_features</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;IsHoliday&#39;</span><span class="p">,</span> <span class="s1">&#39;Type&#39;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">feature_name</span> <span class="ow">in</span> <span class="n">indicator_features</span><span class="p">:</span>
        <span class="c1"># CODE HERE</span>
        <span class="n">dtype</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">int64</span> <span class="k">if</span> <span class="n">feature_name</span> <span class="o">==</span> <span class="s1">&#39;IsHoliday&#39;</span> <span class="k">else</span> <span class="n">tf</span><span class="o">.</span><span class="n">string</span>
        <span class="n">vocab_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">final_dataset</span><span class="p">[</span><span class="n">feature_name</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
        <span class="n">vocab_col</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">feature_column</span><span class="o">.</span><span class="n">categorical_column_with_vocabulary_list</span><span class="p">(</span><span class="n">feature_name</span><span class="p">,</span> <span class="n">vocab_list</span><span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span> <span class="n">dtype</span><span class="p">)</span>
        <span class="n">feature_col</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">feature_column</span><span class="o">.</span><span class="n">indicator_column</span><span class="p">(</span><span class="n">vocab_col</span><span class="p">)</span>
        <span class="n">feature_columns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">feature_col</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># help(tf.feature_column.indicator_column)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="embedding-columns">
<h3>Embedding Columns<a class="headerlink" href="#embedding-columns" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stores</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">46</span><span class="p">))</span> <span class="c1"># There are 45 stores in the dataset, labeled from 1-45</span>
<span class="n">stores_col</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">feature_column</span><span class="o">.</span><span class="n">categorical_column_with_vocabulary_list</span><span class="p">(</span><span class="s1">&#39;StoreID&#39;</span><span class="p">,</span> <span class="n">stores</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>
<span class="n">embedding_dim</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mi">45</span><span class="o">**</span><span class="mf">0.25</span><span class="p">)</span>  <span class="c1"># 4th root - </span>
<span class="c1"># set the vector dimension to anything, but a good rule of thumb is to set it equal to the </span>
<span class="c1"># 4th root of the size of the vocabulary list.</span>

<span class="n">feature_col</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">feature_column</span><span class="o">.</span><span class="n">embedding_column</span><span class="p">(</span><span class="n">stores_col</span><span class="p">,</span> <span class="n">embedding_dim</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Add the embedding feature columns to the list of feature columns</span>
<span class="k">def</span> <span class="nf">add_embedding_columns</span><span class="p">(</span><span class="n">final_dataset</span><span class="p">,</span> <span class="n">feature_columns</span><span class="p">):</span>
    <span class="n">embedding_features</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Store&#39;</span><span class="p">,</span> <span class="s1">&#39;Dept&#39;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">feature_name</span> <span class="ow">in</span> <span class="n">embedding_features</span><span class="p">:</span>
        <span class="n">vocab_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">final_dataset</span><span class="p">[</span><span class="n">feature_name</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
        <span class="n">vocab_col</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">feature_column</span><span class="o">.</span><span class="n">categorical_column_with_vocabulary_list</span><span class="p">(</span>
            <span class="n">feature_name</span><span class="p">,</span> <span class="n">vocab_list</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>
        <span class="n">embedding_dim</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">vocab_list</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.25</span><span class="p">)</span>
        
        <span class="n">feature_col</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">feature_column</span><span class="o">.</span><span class="n">embedding_column</span><span class="p">(</span><span class="n">vocab_col</span><span class="p">,</span> <span class="n">embedding_dim</span><span class="p">)</span>
        <span class="n">feature_columns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">feature_col</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="model-input-layer">
<h3>Model Input Layer<a class="headerlink" href="#model-input-layer" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Aggregate the feature columns for the machine learning model’s input layer</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">create_feature_columns</span><span class="p">(</span><span class="n">final_dataset</span><span class="p">):</span>
    <span class="n">feature_columns</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">add_numeric_columns</span><span class="p">(</span><span class="n">feature_columns</span><span class="p">)</span>
    <span class="n">add_indicator_columns</span><span class="p">(</span><span class="n">final_dataset</span><span class="p">,</span> <span class="n">feature_columns</span><span class="p">)</span>
    <span class="n">add_embedding_columns</span><span class="p">(</span><span class="n">final_dataset</span><span class="p">,</span> <span class="n">feature_columns</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">feature_columns</span>

<span class="n">feature_columns</span> <span class="o">=</span> <span class="n">create_feature_columns</span><span class="p">(</span><span class="n">final_dataset</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">feature_columns</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[NumericColumn(key=&#39;Size&#39;, shape=(), default_value=None, dtype=tf.float32, normalizer_fn=None),
 NumericColumn(key=&#39;Temperature&#39;, shape=(), default_value=None, dtype=tf.float32, normalizer_fn=None),
 NumericColumn(key=&#39;Fuel_Price&#39;, shape=(), default_value=None, dtype=tf.float32, normalizer_fn=None),
 NumericColumn(key=&#39;CPI&#39;, shape=(), default_value=None, dtype=tf.float32, normalizer_fn=None),
 NumericColumn(key=&#39;Unemployment&#39;, shape=(), default_value=None, dtype=tf.float32, normalizer_fn=None),
 IndicatorColumn(categorical_column=VocabularyListCategoricalColumn(key=&#39;IsHoliday&#39;, vocabulary_list=(0, 1), dtype=tf.int64, default_value=-1, num_oov_buckets=0)),
 IndicatorColumn(categorical_column=VocabularyListCategoricalColumn(key=&#39;Type&#39;, vocabulary_list=(&#39;A&#39;, &#39;B&#39;, &#39;C&#39;), dtype=tf.string, default_value=-1, num_oov_buckets=0)),
 EmbeddingColumn(categorical_column=VocabularyListCategoricalColumn(key=&#39;Store&#39;, vocabulary_list=(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45), dtype=tf.int64, default_value=-1, num_oov_buckets=0), dimension=2, combiner=&#39;mean&#39;, initializer=&lt;tensorflow.python.ops.init_ops.TruncatedNormal object at 0x7faad9d80040&gt;, ckpt_to_load_from=None, tensor_name_in_ckpt=None, max_norm=None, trainable=True, use_safe_embedding_lookup=True),
 EmbeddingColumn(categorical_column=VocabularyListCategoricalColumn(key=&#39;Dept&#39;, vocabulary_list=(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 40, 41, 42, 44, 45, 46, 47, 48, 49, 51, 52, 54, 55, 56, 58, 59, 60, 67, 71, 72, 74, 79, 80, 81, 82, 83, 85, 87, 90, 91, 92, 93, 94, 95, 97, 98, 78, 96, 99, 77, 39, 50, 43, 65), dtype=tf.int64, default_value=-1, num_oov_buckets=0), dimension=3, combiner=&#39;mean&#39;, initializer=&lt;tensorflow.python.ops.init_ops.TruncatedNormal object at 0x7faad9d80700&gt;, ckpt_to_load_from=None, tensor_name_in_ckpt=None, max_norm=None, trainable=True, use_safe_embedding_lookup=True)]
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="model-predictions">
<h2>Model Predictions<a class="headerlink" href="#model-predictions" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>predicting weekly sales for various retail stores</p></li>
</ul>
<section id="model-layers">
<h3>Model Layers<a class="headerlink" href="#model-layers" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">SalesModel</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hidden_layers</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hidden_layers</span> <span class="o">=</span> <span class="n">hidden_layers</span>

    <span class="k">def</span> <span class="nf">model_layers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">):</span>
        <span class="n">layer</span> <span class="o">=</span> <span class="n">inputs</span>
        <span class="k">for</span> <span class="n">num_nodes</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">hidden_layers</span><span class="p">:</span>
            <span class="n">layer</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">num_nodes</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">relu</span><span class="p">)(</span><span class="n">layer</span><span class="p">)</span>
        <span class="n">batch_predictions</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">)(</span><span class="n">layer</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">batch_predictions</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="regression-function">
<h3>Regression Function<a class="headerlink" href="#regression-function" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># inputs = input_layer(features, cols)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">SalesModel</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hidden_layers</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hidden_layers</span> <span class="o">=</span> <span class="n">hidden_layers</span>

    <span class="k">def</span> <span class="nf">model_layers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">):</span>
        <span class="n">layer</span> <span class="o">=</span> <span class="n">inputs</span>
        <span class="k">for</span> <span class="n">num_nodes</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">hidden_layers</span><span class="p">:</span>
            <span class="n">layer</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">num_nodes</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">relu</span><span class="p">)(</span><span class="n">layer</span><span class="p">)</span>
        <span class="n">batch_predictions</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">)(</span><span class="n">layer</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">batch_predictions</span>

    <span class="k">def</span> <span class="nf">regression_fn</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="n">feature_columns</span> <span class="o">=</span> <span class="n">create_feature_columns</span><span class="p">()</span>
        <span class="n">inputs</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">compat</span><span class="o">.</span><span class="n">v1</span><span class="o">.</span><span class="n">feature_column</span><span class="o">.</span><span class="n">input_layer</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">feature_columns</span><span class="p">)</span>
        <span class="n">batch_predictions</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_layers</span><span class="p">(</span><span class="n">inputts</span><span class="p">)</span>
        <span class="n">predictions</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">batch_predictions</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">labels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">loss</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">compat</span><span class="o">.</span><span class="n">v1</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">absolute_difference</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">predictions</span><span class="p">)</span>
        
<span class="c1"># help(tf.compat.v1.feature_column.input_layer)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="training-mode">
<h3>Training mode<a class="headerlink" href="#training-mode" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">SalesModel</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hidden_layers</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hidden_layers</span> <span class="o">=</span> <span class="n">hidden_layers</span>

    <span class="k">def</span> <span class="nf">model_layers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">):</span>
        <span class="n">layer</span> <span class="o">=</span> <span class="n">inputs</span>
        <span class="k">for</span> <span class="n">num_nodes</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">hidden_layers</span><span class="p">:</span>
            <span class="n">layer</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">num_nodes</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">relu</span><span class="p">)(</span><span class="n">layer</span><span class="p">)</span>
        <span class="n">batch_predictions</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">)(</span><span class="n">layer</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">batch_predictions</span>

    <span class="k">def</span> <span class="nf">regression_fn</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="n">feature_columns</span> <span class="o">=</span> <span class="n">create_feature_columns</span><span class="p">()</span>
        <span class="n">inputs</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">compat</span><span class="o">.</span><span class="n">v1</span><span class="o">.</span><span class="n">feature_column</span><span class="o">.</span><span class="n">input_layer</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">feature_columns</span><span class="p">)</span>
        <span class="n">batch_predictions</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_layers</span><span class="p">(</span><span class="n">inputts</span><span class="p">)</span>
        <span class="n">predictions</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">batch_predictions</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">labels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">loss</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">compat</span><span class="o">.</span><span class="n">v1</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">absolute_difference</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">predictions</span><span class="p">)</span>
        <span class="c1"># regression function’s training code</span>
        <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="n">tf</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">ModeKeys</span><span class="o">.</span><span class="n">TRAIN</span><span class="p">:</span>
            <span class="c1"># to keep track of total number of training steps during different training runs</span>
            <span class="n">global_step</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">compat</span><span class="o">.</span><span class="n">v1</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">get_or_create_global_step</span><span class="p">()</span>
            <span class="c1"># minimize model&#39;s loss during training using ADAM optimization method</span>
            <span class="n">adam</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">compat</span><span class="o">.</span><span class="n">v1</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">AdamOptimizer</span><span class="p">()</span>
            <span class="n">train_op</span> <span class="o">=</span> <span class="n">adam</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">loss</span><span class="p">,</span> <span class="n">global_step</span><span class="o">=</span><span class="n">global_step</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">tf</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">EstimatorSpec</span><span class="p">(</span><span class="n">mode</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="n">loss</span><span class="p">,</span> <span class="n">train_op</span><span class="o">=</span><span class="n">train_op</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="evaluation-mode">
<h3>Evaluation Mode<a class="headerlink" href="#evaluation-mode" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">SalesModel</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hidden_layers</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hidden_layers</span> <span class="o">=</span> <span class="n">hidden_layers</span>

    <span class="k">def</span> <span class="nf">model_layers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">):</span>
        <span class="n">layer</span> <span class="o">=</span> <span class="n">inputs</span>
        <span class="k">for</span> <span class="n">num_nodes</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">hidden_layers</span><span class="p">:</span>
            <span class="n">layer</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">num_nodes</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">relu</span><span class="p">)(</span><span class="n">layer</span><span class="p">)</span>
        <span class="n">batch_predictions</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">)(</span><span class="n">layer</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">batch_predictions</span>

    <span class="k">def</span> <span class="nf">regression_fn</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="n">feature_columns</span> <span class="o">=</span> <span class="n">create_feature_columns</span><span class="p">()</span>
        <span class="n">inputs</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">compat</span><span class="o">.</span><span class="n">v1</span><span class="o">.</span><span class="n">feature_column</span><span class="o">.</span><span class="n">input_layer</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">feature_columns</span><span class="p">)</span>
        <span class="n">batch_predictions</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_layers</span><span class="p">(</span><span class="n">inputts</span><span class="p">)</span>
        <span class="n">predictions</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">batch_predictions</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">labels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">loss</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">compat</span><span class="o">.</span><span class="n">v1</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">absolute_difference</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">predictions</span><span class="p">)</span>
        <span class="c1"># regression function’s training code</span>
        <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="n">tf</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">ModeKeys</span><span class="o">.</span><span class="n">TRAIN</span><span class="p">:</span>
            <span class="c1"># to keep track of total number of training steps during different training runs</span>
            <span class="n">global_step</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">compat</span><span class="o">.</span><span class="n">v1</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">get_or_create_global_step</span><span class="p">()</span>
            <span class="c1"># minimize model&#39;s loss during training using ADAM optimization method</span>
            <span class="n">adam</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">compat</span><span class="o">.</span><span class="n">v1</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">AdamOptimizer</span><span class="p">()</span>
            <span class="n">train_op</span> <span class="o">=</span> <span class="n">adam</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">loss</span><span class="p">,</span> <span class="n">global_step</span><span class="o">=</span><span class="n">global_step</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">tf</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">EstimatorSpec</span><span class="p">(</span><span class="n">mode</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="n">loss</span><span class="p">,</span> <span class="n">train_op</span><span class="o">=</span><span class="n">train_op</span><span class="p">)</span>
        <span class="c1"># regression function’s evaluation code</span>
        <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="n">tf</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">ModeKeys</span><span class="o">.</span><span class="n">EVAL</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">tf</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">EstimatorSpec</span><span class="p">(</span><span class="n">mode</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="n">loss</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="prediction-mode">
<h3>Prediction Mode<a class="headerlink" href="#prediction-mode" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">SalesModel</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hidden_layers</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hidden_layers</span> <span class="o">=</span> <span class="n">hidden_layers</span>

    <span class="k">def</span> <span class="nf">model_layers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">):</span>
        <span class="n">layer</span> <span class="o">=</span> <span class="n">inputs</span>
        <span class="k">for</span> <span class="n">num_nodes</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">hidden_layers</span><span class="p">:</span>
            <span class="n">layer</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">num_nodes</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">relu</span><span class="p">)(</span><span class="n">layer</span><span class="p">)</span>
        <span class="n">batch_predictions</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">)(</span><span class="n">layer</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">batch_predictions</span>

    <span class="k">def</span> <span class="nf">regression_fn</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="n">feature_columns</span> <span class="o">=</span> <span class="n">create_feature_columns</span><span class="p">()</span>
        <span class="n">inputs</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">compat</span><span class="o">.</span><span class="n">v1</span><span class="o">.</span><span class="n">feature_column</span><span class="o">.</span><span class="n">input_layer</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">feature_columns</span><span class="p">)</span>
        <span class="n">batch_predictions</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_layers</span><span class="p">(</span><span class="n">inputts</span><span class="p">)</span>
        <span class="n">predictions</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">batch_predictions</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">labels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">loss</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">compat</span><span class="o">.</span><span class="n">v1</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">absolute_difference</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">predictions</span><span class="p">)</span>
        <span class="c1"># regression function’s training code</span>
        <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="n">tf</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">ModeKeys</span><span class="o">.</span><span class="n">TRAIN</span><span class="p">:</span>
            <span class="c1"># to keep track of total number of training steps during different training runs</span>
            <span class="n">global_step</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">compat</span><span class="o">.</span><span class="n">v1</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">get_or_create_global_step</span><span class="p">()</span>
            <span class="c1"># minimize model&#39;s loss during training using ADAM optimization method</span>
            <span class="n">adam</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">compat</span><span class="o">.</span><span class="n">v1</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">AdamOptimizer</span><span class="p">()</span>
            <span class="n">train_op</span> <span class="o">=</span> <span class="n">adam</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">loss</span><span class="p">,</span> <span class="n">global_step</span><span class="o">=</span><span class="n">global_step</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">tf</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">EstimatorSpec</span><span class="p">(</span><span class="n">mode</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="n">loss</span><span class="p">,</span> <span class="n">train_op</span><span class="o">=</span><span class="n">train_op</span><span class="p">)</span>
        <span class="c1"># regression function’s evaluation code</span>
        <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="n">tf</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">ModeKeys</span><span class="o">.</span><span class="n">EVAL</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">tf</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">EstimatorSpec</span><span class="p">(</span><span class="n">mode</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="n">loss</span><span class="p">)</span>
        <span class="c1"># regression function’s prediction code</span>
        <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="n">tf</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">ModeKeys</span><span class="o">.</span><span class="n">PREDICT</span><span class="p">:</span>
            <span class="n">prediction_info</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;predictions&#39;</span><span class="p">:</span> <span class="n">batch_predictions</span><span class="p">}</span>
            <span class="k">return</span> <span class="n">tf</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">EstimatorSpec</span><span class="p">(</span><span class="n">mode</span><span class="p">,</span> <span class="n">predictions</span><span class="o">=</span><span class="n">prediction_info</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="regression-model">
<h3>Regression Model<a class="headerlink" href="#regression-model" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>create an Estimator object for the regression model</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">SalesModel</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hidden_layers</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hidden_layers</span> <span class="o">=</span> <span class="n">hidden_layers</span>

    <span class="k">def</span> <span class="nf">model_layers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">):</span>
        <span class="n">layer</span> <span class="o">=</span> <span class="n">inputs</span>
        <span class="k">for</span> <span class="n">num_nodes</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">hidden_layers</span><span class="p">:</span>
            <span class="n">layer</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">num_nodes</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">relu</span><span class="p">)(</span><span class="n">layer</span><span class="p">)</span>
        <span class="n">batch_predictions</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">)(</span><span class="n">layer</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">batch_predictions</span>

    <span class="k">def</span> <span class="nf">regression_fn</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="n">feature_columns</span> <span class="o">=</span> <span class="n">create_feature_columns</span><span class="p">()</span>
        <span class="n">inputs</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">compat</span><span class="o">.</span><span class="n">v1</span><span class="o">.</span><span class="n">feature_column</span><span class="o">.</span><span class="n">input_layer</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">feature_columns</span><span class="p">)</span>
        <span class="n">batch_predictions</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_layers</span><span class="p">(</span><span class="n">inputts</span><span class="p">)</span>
        <span class="n">predictions</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">batch_predictions</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">labels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">loss</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">compat</span><span class="o">.</span><span class="n">v1</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">absolute_difference</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">predictions</span><span class="p">)</span>
        <span class="c1"># regression function’s training code</span>
        <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="n">tf</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">ModeKeys</span><span class="o">.</span><span class="n">TRAIN</span><span class="p">:</span>
            <span class="c1"># to keep track of total number of training steps during different training runs</span>
            <span class="n">global_step</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">compat</span><span class="o">.</span><span class="n">v1</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">get_or_create_global_step</span><span class="p">()</span>
            <span class="c1"># minimize model&#39;s loss during training using ADAM optimization method</span>
            <span class="n">adam</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">compat</span><span class="o">.</span><span class="n">v1</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">AdamOptimizer</span><span class="p">()</span>
            <span class="n">train_op</span> <span class="o">=</span> <span class="n">adam</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">loss</span><span class="p">,</span> <span class="n">global_step</span><span class="o">=</span><span class="n">global_step</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">tf</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">EstimatorSpec</span><span class="p">(</span><span class="n">mode</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="n">loss</span><span class="p">,</span> <span class="n">train_op</span><span class="o">=</span><span class="n">train_op</span><span class="p">)</span>
        <span class="c1"># regression function’s evaluation code</span>
        <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="n">tf</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">ModeKeys</span><span class="o">.</span><span class="n">EVAL</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">tf</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">EstimatorSpec</span><span class="p">(</span><span class="n">mode</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="n">loss</span><span class="p">)</span>
        <span class="c1"># regression function’s prediction code</span>
        <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="n">tf</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">ModeKeys</span><span class="o">.</span><span class="n">PREDICT</span><span class="p">:</span>
            <span class="n">prediction_info</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;predictions&#39;</span><span class="p">:</span> <span class="n">batch_predictions</span><span class="p">}</span>
            <span class="k">return</span> <span class="n">tf</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">EstimatorSpec</span><span class="p">(</span><span class="n">mode</span><span class="p">,</span> <span class="n">predictions</span><span class="o">=</span><span class="n">prediction_info</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">create_regression_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ckpt_dir</span><span class="p">):</span>
        <span class="c1"># configuration for training logs the loss and global step values every 5000 training steps</span>
        <span class="n">config</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">RunConfig</span><span class="p">(</span><span class="n">log_step_count_steps</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>
        <span class="n">regression_model</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">Estimator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">regression_fn</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">,</span> <span class="n">model_dir</span><span class="o">=</span><span class="n">ckpt_dir</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">regression_model</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="model-training">
<h3>Model Training<a class="headerlink" href="#model-training" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Train the regression model using train.tfrecords file</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">SalesModel</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hidden_layers</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hidden_layers</span> <span class="o">=</span> <span class="n">hidden_layers</span>

    <span class="k">def</span> <span class="nf">model_layers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">):</span>
        <span class="n">layer</span> <span class="o">=</span> <span class="n">inputs</span>
        <span class="k">for</span> <span class="n">num_nodes</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">hidden_layers</span><span class="p">:</span>
            <span class="n">layer</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">num_nodes</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">relu</span><span class="p">)(</span><span class="n">layer</span><span class="p">)</span>
        <span class="n">batch_predictions</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">)(</span><span class="n">layer</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">batch_predictions</span>

    <span class="k">def</span> <span class="nf">regression_fn</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="n">feature_columns</span> <span class="o">=</span> <span class="n">create_feature_columns</span><span class="p">()</span>
        <span class="n">inputs</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">compat</span><span class="o">.</span><span class="n">v1</span><span class="o">.</span><span class="n">feature_column</span><span class="o">.</span><span class="n">input_layer</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">feature_columns</span><span class="p">)</span>
        <span class="n">batch_predictions</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_layers</span><span class="p">(</span><span class="n">inputts</span><span class="p">)</span>
        <span class="n">predictions</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">batch_predictions</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">labels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">loss</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">compat</span><span class="o">.</span><span class="n">v1</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">absolute_difference</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">predictions</span><span class="p">)</span>
        <span class="c1"># regression function’s training code</span>
        <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="n">tf</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">ModeKeys</span><span class="o">.</span><span class="n">TRAIN</span><span class="p">:</span>
            <span class="c1"># to keep track of total number of training steps during different training runs</span>
            <span class="n">global_step</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">compat</span><span class="o">.</span><span class="n">v1</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">get_or_create_global_step</span><span class="p">()</span>
            <span class="c1"># minimize model&#39;s loss during training using ADAM optimization method</span>
            <span class="n">adam</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">compat</span><span class="o">.</span><span class="n">v1</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">AdamOptimizer</span><span class="p">()</span>
            <span class="n">train_op</span> <span class="o">=</span> <span class="n">adam</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">loss</span><span class="p">,</span> <span class="n">global_step</span><span class="o">=</span><span class="n">global_step</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">tf</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">EstimatorSpec</span><span class="p">(</span><span class="n">mode</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="n">loss</span><span class="p">,</span> <span class="n">train_op</span><span class="o">=</span><span class="n">train_op</span><span class="p">)</span>
        <span class="c1"># regression function’s evaluation code</span>
        <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="n">tf</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">ModeKeys</span><span class="o">.</span><span class="n">EVAL</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">tf</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">EstimatorSpec</span><span class="p">(</span><span class="n">mode</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="n">loss</span><span class="p">)</span>
        <span class="c1"># regression function’s prediction code</span>
        <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="n">tf</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">ModeKeys</span><span class="o">.</span><span class="n">PREDICT</span><span class="p">:</span>
            <span class="n">prediction_info</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;predictions&#39;</span><span class="p">:</span> <span class="n">batch_predictions</span><span class="p">}</span>
            <span class="k">return</span> <span class="n">tf</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">EstimatorSpec</span><span class="p">(</span><span class="n">mode</span><span class="p">,</span> <span class="n">predictions</span><span class="o">=</span><span class="n">prediction_info</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">create_regression_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ckpt_dir</span><span class="p">):</span>
        <span class="c1"># configuration for training logs the loss and global step values every 5000 training steps</span>
        <span class="n">config</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">RunConfig</span><span class="p">(</span><span class="n">log_step_count_steps</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>
        <span class="n">regression_model</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">Estimator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">regression_fn</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">,</span> <span class="n">model_dir</span><span class="o">=</span><span class="n">ckpt_dir</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">regression_model</span>
    
    <span class="k">def</span> <span class="nf">run_regression_training</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ckpt_dir</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">,</span> <span class="n">num_training_steps</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="c1"># Setting steps to None will run training until is manually terminated</span>
        <span class="n">regression_model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_regression_model</span><span class="p">(</span><span class="n">ckpt_dir</span><span class="p">)</span>
        <span class="n">input_fn</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span><span class="n">create_tensorflow_dataset</span><span class="p">(</span><span class="s1">&#39;train.tfrecords&#39;</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">)</span>
        <span class="n">regression_model</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">input_fn</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="n">num_training_steps</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="model-evaluation">
<h3>Model Evaluation<a class="headerlink" href="#model-evaluation" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">SalesModel</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hidden_layers</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hidden_layers</span> <span class="o">=</span> <span class="n">hidden_layers</span>

    <span class="k">def</span> <span class="nf">model_layers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">):</span>
        <span class="n">layer</span> <span class="o">=</span> <span class="n">inputs</span>
        <span class="k">for</span> <span class="n">num_nodes</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">hidden_layers</span><span class="p">:</span>
            <span class="n">layer</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">num_nodes</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">relu</span><span class="p">)(</span><span class="n">layer</span><span class="p">)</span>
        <span class="n">batch_predictions</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">)(</span><span class="n">layer</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">batch_predictions</span>

    <span class="k">def</span> <span class="nf">regression_fn</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="n">feature_columns</span> <span class="o">=</span> <span class="n">create_feature_columns</span><span class="p">()</span>
        <span class="n">inputs</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">compat</span><span class="o">.</span><span class="n">v1</span><span class="o">.</span><span class="n">feature_column</span><span class="o">.</span><span class="n">input_layer</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">feature_columns</span><span class="p">)</span>
        <span class="n">batch_predictions</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_layers</span><span class="p">(</span><span class="n">inputts</span><span class="p">)</span>
        <span class="n">predictions</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">batch_predictions</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">labels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">loss</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">compat</span><span class="o">.</span><span class="n">v1</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">absolute_difference</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">predictions</span><span class="p">)</span>
        <span class="c1"># regression function’s training code</span>
        <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="n">tf</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">ModeKeys</span><span class="o">.</span><span class="n">TRAIN</span><span class="p">:</span>
            <span class="c1"># to keep track of total number of training steps during different training runs</span>
            <span class="n">global_step</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">compat</span><span class="o">.</span><span class="n">v1</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">get_or_create_global_step</span><span class="p">()</span>
            <span class="c1"># minimize model&#39;s loss during training using ADAM optimization method</span>
            <span class="n">adam</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">compat</span><span class="o">.</span><span class="n">v1</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">AdamOptimizer</span><span class="p">()</span>
            <span class="n">train_op</span> <span class="o">=</span> <span class="n">adam</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">loss</span><span class="p">,</span> <span class="n">global_step</span><span class="o">=</span><span class="n">global_step</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">tf</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">EstimatorSpec</span><span class="p">(</span><span class="n">mode</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="n">loss</span><span class="p">,</span> <span class="n">train_op</span><span class="o">=</span><span class="n">train_op</span><span class="p">)</span>
        <span class="c1"># regression function’s evaluation code</span>
        <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="n">tf</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">ModeKeys</span><span class="o">.</span><span class="n">EVAL</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">tf</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">EstimatorSpec</span><span class="p">(</span><span class="n">mode</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="n">loss</span><span class="p">)</span>
        <span class="c1"># regression function’s prediction code</span>
        <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="n">tf</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">ModeKeys</span><span class="o">.</span><span class="n">PREDICT</span><span class="p">:</span>
            <span class="n">prediction_info</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;predictions&#39;</span><span class="p">:</span> <span class="n">batch_predictions</span><span class="p">}</span>
            <span class="k">return</span> <span class="n">tf</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">EstimatorSpec</span><span class="p">(</span><span class="n">mode</span><span class="p">,</span> <span class="n">predictions</span><span class="o">=</span><span class="n">prediction_info</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">create_regression_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ckpt_dir</span><span class="p">):</span>
        <span class="c1"># configuration for training logs the loss and global step values every 5000 training steps</span>
        <span class="n">config</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">RunConfig</span><span class="p">(</span><span class="n">log_step_count_steps</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>
        <span class="n">regression_model</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">Estimator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">regression_fn</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">,</span> <span class="n">model_dir</span><span class="o">=</span><span class="n">ckpt_dir</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">regression_model</span>
    
    <span class="k">def</span> <span class="nf">run_regression_training</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ckpt_dir</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">,</span> <span class="n">num_training_steps</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="c1"># Setting steps to None will run training until is manually terminated</span>
        <span class="n">regression_model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_regression_model</span><span class="p">(</span><span class="n">ckpt_dir</span><span class="p">)</span>
        <span class="n">input_fn</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span><span class="n">create_tensorflow_dataset</span><span class="p">(</span><span class="s1">&#39;train.tfrecords&#39;</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">)</span>
        <span class="n">regression_model</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">input_fn</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="n">num_training_steps</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">run_regression_eval</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ckpt_dir</span><span class="p">):</span>
        <span class="n">regression_model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_regression_model</span><span class="p">(</span><span class="n">ckpt_dir</span><span class="p">)</span>
        <span class="n">input_fn</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span><span class="n">create_tensorflow_dataset</span><span class="p">(</span><span class="s1">&#39;eval.tfrecords&#39;</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="n">training</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">regression_model</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">input_fn</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="making-predictions">
<h3>Making Predictions<a class="headerlink" href="#making-predictions" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>using regression model to make predictions on unlabeled test dataset</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">SalesModel</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hidden_layers</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hidden_layers</span> <span class="o">=</span> <span class="n">hidden_layers</span>

    <span class="k">def</span> <span class="nf">model_layers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">):</span>
        <span class="n">layer</span> <span class="o">=</span> <span class="n">inputs</span>
        <span class="k">for</span> <span class="n">num_nodes</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">hidden_layers</span><span class="p">:</span>
            <span class="n">layer</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">num_nodes</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">relu</span><span class="p">)(</span><span class="n">layer</span><span class="p">)</span>
        <span class="n">batch_predictions</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">)(</span><span class="n">layer</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">batch_predictions</span>

    <span class="k">def</span> <span class="nf">regression_fn</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="n">feature_columns</span> <span class="o">=</span> <span class="n">create_feature_columns</span><span class="p">()</span>
        <span class="n">inputs</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">compat</span><span class="o">.</span><span class="n">v1</span><span class="o">.</span><span class="n">feature_column</span><span class="o">.</span><span class="n">input_layer</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">feature_columns</span><span class="p">)</span>
        <span class="n">batch_predictions</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_layers</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
        <span class="n">predictions</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">batch_predictions</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">labels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">loss</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">compat</span><span class="o">.</span><span class="n">v1</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">absolute_difference</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">predictions</span><span class="p">)</span>
        <span class="c1"># regression function’s training code</span>
        <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="n">tf</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">ModeKeys</span><span class="o">.</span><span class="n">TRAIN</span><span class="p">:</span>
            <span class="c1"># to keep track of total number of training steps during different training runs</span>
            <span class="n">global_step</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">compat</span><span class="o">.</span><span class="n">v1</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">get_or_create_global_step</span><span class="p">()</span>
            <span class="c1"># minimize model&#39;s loss during training using ADAM optimization method</span>
            <span class="n">adam</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">compat</span><span class="o">.</span><span class="n">v1</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">AdamOptimizer</span><span class="p">()</span>
            <span class="n">train_op</span> <span class="o">=</span> <span class="n">adam</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">loss</span><span class="p">,</span> <span class="n">global_step</span><span class="o">=</span><span class="n">global_step</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">tf</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">EstimatorSpec</span><span class="p">(</span><span class="n">mode</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="n">loss</span><span class="p">,</span> <span class="n">train_op</span><span class="o">=</span><span class="n">train_op</span><span class="p">)</span>
        <span class="c1"># regression function’s evaluation code</span>
        <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="n">tf</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">ModeKeys</span><span class="o">.</span><span class="n">EVAL</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">tf</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">EstimatorSpec</span><span class="p">(</span><span class="n">mode</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="n">loss</span><span class="p">)</span>
        <span class="c1"># regression function’s prediction code</span>
        <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="n">tf</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">ModeKeys</span><span class="o">.</span><span class="n">PREDICT</span><span class="p">:</span>
            <span class="n">prediction_info</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;predictions&#39;</span><span class="p">:</span> <span class="n">batch_predictions</span><span class="p">}</span>
            <span class="k">return</span> <span class="n">tf</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">EstimatorSpec</span><span class="p">(</span><span class="n">mode</span><span class="p">,</span> <span class="n">predictions</span><span class="o">=</span><span class="n">prediction_info</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">create_regression_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ckpt_dir</span><span class="p">):</span>
        <span class="c1"># configuration for training logs the loss and global step values every 5000 training steps</span>
        <span class="n">config</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">RunConfig</span><span class="p">(</span><span class="n">log_step_count_steps</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>
        <span class="n">regression_model</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">Estimator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">regression_fn</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">,</span> <span class="n">model_dir</span><span class="o">=</span><span class="n">ckpt_dir</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">regression_model</span>
    
    <span class="k">def</span> <span class="nf">run_regression_training</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ckpt_dir</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">,</span> <span class="n">num_training_steps</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="c1"># Setting steps to None will run training until is manually terminated</span>
        <span class="n">regression_model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_regression_model</span><span class="p">(</span><span class="n">ckpt_dir</span><span class="p">)</span>
        <span class="n">input_fn</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span><span class="n">create_tensorflow_dataset</span><span class="p">(</span><span class="s1">&#39;train.tfrecords&#39;</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">)</span>
        <span class="n">regression_model</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">input_fn</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="n">num_training_steps</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">run_regression_eval</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ckpt_dir</span><span class="p">):</span>
        <span class="n">regression_model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_regression_model</span><span class="p">(</span><span class="n">ckpt_dir</span><span class="p">)</span>
        <span class="n">input_fn</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span><span class="n">create_tensorflow_dataset</span><span class="p">(</span><span class="s1">&#39;eval.tfrecords&#39;</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="n">training</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">regression_model</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">input_fn</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">run_regression_predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ckpt_dir</span><span class="p">,</span> <span class="n">data_file</span><span class="p">):</span>
        <span class="n">regression_model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_regression_model</span><span class="p">(</span><span class="n">ckpt_dir</span><span class="p">)</span>
        <span class="n">input_fn</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span><span class="n">create_tensorflow_dataset</span><span class="p">(</span><span class="n">data_file</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">training</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">has_labels</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">predictions</span> <span class="o">=</span> <span class="n">regression_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">input_fn</span><span class="p">)</span>
        <span class="n">pred_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">pred_dict</span> <span class="ow">in</span> <span class="n">predictions</span><span class="p">:</span>
            <span class="n">pred_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pred_dict</span><span class="p">[</span><span class="s1">&#39;predictions&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">pred_list</span>
    
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="result-summary">
<h2>⛏ Result Summary<a class="headerlink" href="#result-summary" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># TODO: Execute it!!</span>

<span class="c1"># run_regression_predict(&#39;test.tfrecords&#39;)</span>
<span class="c1"># # Making Predictions</span>
<span class="c1"># input_fn = lambda:create_tensorflow_dataset(&#39;test.tfrecords&#39;, 1, training=False, has_labels=False)</span>
<span class="c1"># predictions = regression_model.predict(input_fn)</span>

<span class="n">ckpt_dir</span> <span class="o">=</span> <span class="s1">&#39;./storeSalesForecasting/&#39;</span>
<span class="n">batch_size</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">data_file</span> <span class="o">=</span> <span class="s1">&#39;eval.tfrecords&#39;</span>

<span class="n">nn</span> <span class="o">=</span> <span class="n">SalesModel</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># nn.run_regression_training(ckpt_dir, batch_size, num_training_steps=None)</span>
<span class="c1"># eval_list = nn.run_regression_eval(ckpt_dir)</span>
<span class="c1"># pred_list = nn.run_regression_predict(ckpt_dir, data_file)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># (fast) ml_examples &gt;&gt; tensorboard --logdir=~/anaconda3/workingDir/learnings/ml_examples/</span>

<span class="c1"># NOTE: Using experimental fast data loading logic. To disable, pass</span>
<span class="c1">#     &quot;--load_fast=false&quot; and report issues on GitHub. More details:</span>
<span class="c1">#     https://github.com/tensorflow/tensorboard/issues/4784</span>

<span class="c1"># Serving TensorBoard on localhost; to expose to the network, use a proxy or pass --bind_all</span>
<span class="c1"># TensorBoard 2.8.0 at http://localhost:6006/ (Press CTRL+C to quit)</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p><a class="reference external" href="https://medium.com/nerd-for-tech/walmart-sales-time-series-forecasting-using-deep-learning-e7a5d47c448b">https://medium.com/nerd-for-tech/walmart-sales-time-series-forecasting-using-deep-learning-e7a5d47c448b</a></p></li>
<li><p><a class="reference external" href="https://github.com/abhinav-bhardwaj/Walmart-Sales-Time-Series-Forecasting-Using-Machine-Learning/blob/master/Walmart_Time_Series_Forecast.ipynb">https://github.com/abhinav-bhardwaj/Walmart-Sales-Time-Series-Forecasting-Using-Machine-Learning/blob/master/Walmart_Time_Series_Forecast.ipynb</a></p></li>
</ul>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./ml_examples"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="ml_glossary.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">ML Conceptual brief</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="decision_tree_classification.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Decision Tree - classification</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Chandra<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>